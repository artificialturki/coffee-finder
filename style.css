:root{
  --ink:#f3fff9; --ink-dim:#d5f2e7; --muted:#a9d3c5;
  --bg1:#0b1411; --bg2:#0c1e17; --bg3:#0a251b;
  --panel:#0f2a20cc; --line:#1f4e3f;
  --mint:#39eba1; --mint2:#1cc57d; --neon:#59ffd4; --accent:#93ff90;
  --radius:16px; --shadow:0 8px 24px rgba(0,0,0,.28)
}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%;scroll-behavior:smooth}
body{
  color:var(--ink);
  font-family:ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,Arial,sans-serif;
  background: radial-gradient(1200px 500px at 20% -10%, #113428 0, var(--bg1) 55%, var(--bg2) 100%);
  overflow-x:hidden; line-height:1.6;
}

/* نجوم خلفية */
.stars,.stars2{
  position:fixed; inset:0; z-index:-2; pointer-events:none;
  background-image:
    radial-gradient(2px 2px at 20% 10%, #aaffee44 50%, transparent 60%),
    radial-gradient(2px 2px at 80% 30%, #aaffee33 50%, transparent 60%),
    radial-gradient(1.5px 1.5px at 60% 70%, #aaffee33 50%, transparent 60%),
    radial-gradient(1.5px 1.5px at 30% 80%, #aaffee33 50%, transparent 60%);
  transition: transform .1s linear;
}
.stars2{ opacity:.55; filter: blur(.4px) }

/* رأس الصفحة */
header{
  position:sticky; top:0; z-index:30;
  background: linear-gradient(180deg, rgba(15,42,32,.92), rgba(15,42,32,.62));
  backdrop-filter: blur(8px);
  border-bottom:1px solid var(--line);
  box-shadow:var(--shadow);
  padding:.75rem 0;
}
.brand{
  font-weight:900; font-size:2rem; letter-spacing:.3px;
  display:flex; align-items:center; gap:.6rem; color:#eafff9;
  text-shadow:0 0 16px #2eeaa055;
  opacity: .94; animation: beat 2.8s ease-in-out infinite;
  cursor:pointer;
}
.brand i{ color:var(--neon); filter:drop-shadow(0 0 8px #2eeaa088); }
@keyframes beat{ 0%,100%{ transform:scale(1); opacity:.92 } 10%{ transform:scale(1.045); opacity:.98 } 20%{ transform:scale(1); opacity:.92 } }

.panel{ background:var(--panel); border:1px solid var(--line); border-radius:var(--radius); box-shadow:var(--shadow) }
.chip-input{ background:#0e261e; border:1px solid var(--line); border-radius:14px; padding:.7rem .9rem; display:flex; align-items:center; gap:.7rem }
.chip-input input{ all:unset; color:var(--ink); width:460px; max-width:60vw; font-size:1.05rem }

.btn-mint{
  background:linear-gradient(180deg,var(--mint),var(--mint2));
  color:#062016; font-weight:800; border:0; border-radius:12px; padding:.65rem 1rem;
  box-shadow:0 10px 24px #22d18940; cursor:pointer; transition:transform .15s ease, filter .15s ease
}
.btn-mint:hover{ filter:brightness(1.07); transform:translateY(-1px) }

.suggest{ position:absolute; top:100%; left:0; right:0; z-index:50; display:none; max-height:320px; overflow-y:auto; border-radius:0 0 var(--radius) var(--radius) }
.suggest a{ display:flex; align-items:center; gap:.55rem; padding:.65rem .8rem; color:var(--ink); text-decoration:none; background:#0f231c; border-bottom:1px solid #1a4536; transition:all .15s ease }
.suggest a:hover{ background:#133b2d; padding-inline-start:1rem }

/* الخريطة */
#map{
  height:62vh; min-height:360px; /* يمنع اختفاء الخريطة */
  border-radius:var(--radius); box-shadow:var(--shadow); position:relative; outline:1px solid var(--line)
}
#map .leaflet-control-zoom{ z-index:1005 }

.map-full{ position:fixed !important; inset:0 !important; width:100vw !important; height:100vh !important; z-index:1050 !important; border-radius:0 !important }
.map-float{ position:absolute; left:12px; bottom:12px; z-index:1004; display:flex; flex-direction:column; gap:.6rem }
.float-btn{
  width:54px; height:54px; border-radius:50%; border:1px solid var(--line);
  background:#0f2a20; color:var(--ink); display:flex; align-items:center; justify-content:center;
  cursor:pointer; box-shadow:var(--shadow); transition:transform .15s ease, background .15s ease
}
.float-btn:hover{ background:#123628; transform:scale(1.05) }

/* زر الخروج من ملء الشاشة */
.exit-fs{ position:fixed; top:12px; right:12px; z-index:20000; display:none }
.exit-fs.show{ display:block }
@media (max-width:768px){
  .exit-fs{ top:auto; bottom:16px; left:50%; right:auto; transform:translateX(-50%) }
  .exit-fs .btn{ padding:.8rem 1.1rem; border-radius:999px }
}

/* أيقونة الكوب مع ذيل ضوء */
.cup{ position:relative; width:26px; height:18px; border-radius:4px 4px 6px 6px; background:#734f35; border:2px solid #523a29 }
.cup:after{ content:""; position:absolute; right:-8px; top:4px; width:8px; height:8px; border:2px solid #523a29; border-left:none; border-radius:0 8px 8px 0 }
.foam{ position:absolute; top:-6px; left:2px; right:2px; height:6px; background:#fff; border-radius:6px 6px 0 0 }
.steam{ position:absolute; top:-18px; left:4px; right:4px; height:14px;
  background: radial-gradient(circle at 30% 60%, #9bf2cf 22%, transparent 50%),
              radial-gradient(circle at 70% 40%, #9bf2cf 22%, transparent 50%);
  filter: blur(1px); opacity:.9; animation:steam 2.6s ease-in-out infinite }
.trail{ position:absolute; bottom:-6px; left:50%; width:16px; height:16px; transform:translateX(-50%); pointer-events:none;
  background: radial-gradient(closest-side, #59ffd4aa, transparent 70%); filter: blur(6px);
  animation: trailPulse 1.8s ease-in-out infinite }
@keyframes steam{ 0%{ transform:translateY(8px); opacity:.35 } 50%{ transform:translateY(-2px); opacity:1 } 100%{ transform:translateY(-10px); opacity:.35 } }
@keyframes trailPulse{ 0%{ transform:translateX(-50%) scale(.7); opacity:.55 } 50%{ transform:translateX(-50%) scale(1.1); opacity:.9 } 100%{ transform:translateX(-50%) scale(.7); opacity:.55 } }

/* النتائج */
.results{ max-height:62vh; min-height:220px; overflow:auto; scrollbar-width:thin; scrollbar-color:#1e4a3a transparent }
.results::-webkit-scrollbar{ width:6px } .results::-webkit-scrollbar-thumb{ background-color:#1e4a3a; border-radius:3px }
.card-cafe{ background:#0e231b; border:1px solid var(--line); border-radius:14px; transition:all .25s; overflow:hidden }
.card-cafe:hover{ transform:translateY(-3px); box-shadow:0 12px 28px rgba(0,0,0,.35); border-color:var(--mint) }
.card-cafe .fw-bold{ color:#fff } /* اسم الكافيه أبيض */
.card-cafe .text-secondary{ color:#e9ffe9 !important } /* حروف أوضح */
.avatar{ width:52px; height:52px; border-radius:14px; background:#fff; border:1px solid #eaeaea; display:flex; align-items:center; justify-content:center; overflow:hidden; flex-shrink:0 }
.avatar img{ width:100%; height:100%; object-fit:cover } .avatar .letter{ font-weight:900; color:#222 }
.stars i{ color:#fff } /* نجوم بيضاء */
.chip{ background:#103c2f; border:1px solid var(--line); padding:.25rem .55rem; border-radius:999px; font-size:.85rem; display:inline-flex; align-items:center; gap:.25rem }
.btn-route{ background:linear-gradient(180deg,var(--mint),var(--mint2)); color:#062016; border:0 }

/* توست + لودر */
.toast-container{ position:fixed; bottom:20px; right:20px; z-index:2100; display:flex; flex-direction:column; gap:10px }
.toast{ background:#0f2a20; color:var(--ink); border:1px solid var(--line); padding:12px 16px; border-radius:var(--radius); box-shadow:var(--shadow); display:flex; align-items:center; gap:10px; animation:toast-in .3s ease; max-width:320px }
@keyframes toast-in{ from{ transform:translateX(100%); opacity:0 } to{ transform:translateX(0); opacity:1 } }
.loader{ display:none; text-align:center; padding:2rem }
.coffee-loader{ display:inline-block; position:relative; width:80px; height:80px }
.coffee-loader div{ display:inline-block; position:absolute; left:8px; width:16px; background:var(--mint); animation:coffee-loader 1.2s cubic-bezier(0,.5,.5,1) infinite; border-radius:20px }
.coffee-loader div:nth-child(1){ left:8px; animation-delay:-.24s } .coffee-loader div:nth-child(2){ left:32px; animation-delay:-.12s } .coffee-loader div:nth-child(3){ left:56px }
@keyframes coffee-loader{ 0%{ top:8px; height:64px } 50%,100%{ top:24px; height:32px } }
.rate{ display:flex; gap:2px } .rate i{ cursor:pointer; transition:transform .15s } .rate i:hover{ transform:scale(1.15) }

/* تجاوبية */
@media (max-width:1200px){ .chip-input input{ width:380px } }
@media (max-width:992px){ #map{ height:50vh } .results{ max-height:50vh } .brand{ font-size:1.7rem } }
@media (max-width:768px){
  .chip-input{ flex-direction:column; align-items:stretch; gap:.5rem }
  .chip-input input{ max-width:100%; width:100% }
  .map-float{ flex-direction:row; bottom:20px; left:50%; transform:translateX(-50%) }
  .float-btn{ width:46px; height:46px }
  header .container{ flex-direction:column; gap:.5rem } .brand{ justify-content:center }
}
@media (max-width:576px){ .panel{ padding:1rem } .chip-input{ padding:.6rem } .brand{ font-size:1.5rem } }
