<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>☕ Coffee Finder Pro — Sci-Fi Edition</title>

  <!-- مكتبات خارجية -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" />
  <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet" />

  <style>
    /* =============================
       🌌 الأساسيات + المتغيرات
    ============================== */
    :root {
      --primary: #734f35;
      --secondary: #8b4513;
      --accent: #c4a484;
      --light: #f5f5f5;
      --dark: #0a1929;
      --success: #00ff8c;
      --warning: #ffd166;
      --danger: #ff6b6b;
      --gray: #6c757d;
      --coffee-light: #d7ccc8;
      --coffee-dark: #5d4037;
      --space-blue: #0a1929;
      --space-purple: #7158e2;
      --neon-blue: #18dcff;
      --neon-pink: #ff4d8d;
      --neon-green: #00ff8c;
      --cyber-yellow: #ffd166;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0e17;
      color: #e9ecef;
      line-height: 1.6;
      overflow-x: hidden;
      transition: all 0.3s ease;
      background-image:
        radial-gradient(circle at 15% 50%, rgba(24,220,255,0.05) 0%, transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(113,88,226,0.05) 0%, transparent 25%),
        radial-gradient(circle at 50% 80%, rgba(255,77,141,0.05) 0%, transparent 25%);
 
    /* =============================
       🛰️ الثيمات
    ============================== */
    [data-theme="light"] {
      --bg-primary: #f8f9fa;
      --bg-secondary: #ffffff;
      --text-primary: #212529;
      --text-secondary: #495057;
      --card-bg: #ffffff;
      --border-color: #dee2e6;
      --header-bg: linear-gradient(135deg, var(--primary), var(--secondary));
    }

    [data-theme="dark"] {
      --bg-primary: #0a1929;
      --bg-secondary: #0f253d;
      --text-primary: #e9ecef;
      --text-secondary: #adb5bd;
      --card-bg: #132238;
      --border-color: #2a3e5a;
      --header-bg: linear-gradient(135deg, #132238, #1e3a5f);
    }

    [data-theme="space"] {
      --bg-primary: #0a0e17;
      --bg-secondary: #0f1525;
      --text-primary: #e9ecef;
      --text-secondary: #8b9bb4;
      --card-bg: #131c2f;
      --border-color: #24334d;
      --header-bg: linear-gradient(135deg, #131c2f, #1e2f4f);
    }

    [data-theme="neon"] {
      --bg-primary: #0a0a0a;
      --bg-secondary: #111;
      --text-primary: #18dcff;
      --text-secondary: #ff4d8d;
      --card-bg: #1a1a1a;
      --border-color: #333;
      --header-bg: linear-gradient(135deg, #18dcff, #7158e2);
    }

    [data-theme="energy"] {
      --bg-primary: #fffdf5;
      --bg-secondary: #fdf2d5;
      --text-primary: #222;
      --text-secondary: #555;
      --card-bg: #fff9e6;
      --border-color: #f0d9b5;
      --header-bg: linear-gradient(135deg, #ffd166, #ff4d8d);
    }

    [data-theme="sleep"] {
      --bg-primary: #001f3f;
      --bg-secondary: #012a4a;
      --text-primary: #cce7ff;
      --text-secondary: #8aaacb;
      --card-bg: #013a63;
      --border-color: #01497c;
      --header-bg: linear-gradient(135deg, #001f3f, #013a63);
    }
    /* =============================
       🌟 الهيدر + بخار الكوب
    ============================== */
    header {
      background: var(--header-bg);
      padding: 20px;
      border-radius: 16px;
      margin: 20px auto;
      max-width: 1400px;
      color: white;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      position: relative;
      overflow: hidden;
    }

    .brand {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      font-size: 2.2rem;
      font-weight: 800;
    }

    .brand i {
      color: var(--neon-blue);
      filter: drop-shadow(0 0 5px var(--neon-blue));
    }

    .coffee-steam {
      display: inline-block;
      margin-left: 10px;
      position: relative;
    }

    .steam {
      position: absolute;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.1));
      margin-top: -25px;
      margin-left: 5px;
      opacity: 0;
    }

    .steam.one { animation: steam-one 4s ease-out infinite; }
    .steam.two { animation: steam-two 4s ease-out 1s infinite; }
    .steam.three { animation: steam-three 4s ease-out 2s infinite; }

    @keyframes steam-one {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-50px) translateX(-10px) scale(1.5); opacity: 0; }
    }

    @keyframes steam-two {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-45px) translateX(10px) scale(1.5); opacity: 0; }
    }

    @keyframes steam-three {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-40px) translateX(-5px) scale(1.5); opacity: 0; }
    }

    /* =============================
       🔍 البحث + الفلاتر
    ============================== */
    .search-panel {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      margin: 20px auto;
      max-width: 1200px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .search-input {
      display: flex;
      gap: 10px;
    }

    .search-input input {
      flex: 1;
      padding: 12px 18px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 1rem;
    }

    .btn-search {
      background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }

    .filters {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }

    .filter-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 8px 15px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
    }

    /* =============================
       🗺️ الخريطة
    ============================== */
    .map-container {
      margin: 20px auto;
      max-width: 1200px;
      height: 550px;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }

    #map { width: 100%; height: 100%; }

  </style>
</head>
<body data-theme="space" class="space-theme">
  <!-- 🗺️ الخريطة الآن أول الصفحة -->
  <section class="map-container">
    <div id="map"></div>
  </section>

  <!-- 🌌 الهيدر -->
  <header>
    <div class="brand">
      <i class="fas fa-mug-hot"></i>
      Coffee Finder Pro
      <div class="coffee-steam">
        <div class="steam one"></div>
        <div class="steam two"></div>
        <div class="steam three"></div>
      </div>
    </div>
  </header>

  <!-- 🔍 لوحة البحث -->
  <section class="search-panel">
    <div class="search-input">
      <input type="text" id="searchInput" placeholder="Search for a city in Saudi Arabia..." />
      <button class="btn-search" id="searchBtn"><i class="fas fa-search"></i> Search</button>
    </div>
    <div class="filters">
      <div class="filter-item"><input type="checkbox" id="wifi"><label for="wifi">Wi-Fi</label></div>
      <div class="filter-item"><input type="checkbox" id="outdoor"><label for="outdoor">Outdoor</label></div>
      <div class="filter-item"><input type="checkbox" id="parking"><label for="parking">Parking</label></div>
      <div class="filter-item"><input type="checkbox" id="openNow"><label for="openNow">Open Now</label></div>
      <div class="filter-item">
        <label for="radius">Radius:</label>
        <select id="radius">
          <option value="1000">1 km</option>
          <option value="3000" selected>3 km</option>
          <option value="5000">5 km</option>
          <option value="10000">10 km</option>
        </select>
      </div>
    </div>
  </section>


  <!-- ☕ نتائج المقاهي -->
  <section class="results-section container">
    <div class="results-header d-flex justify-content-between align-items-center mb-4 p-3"
         style="background: var(--card-bg); border-radius:12px; border:1px solid var(--border-color);">
      <h2 class="results-count">Found <span id="resultsNumber">0</span> coffee shops</h2>
      <select class="sort-select" id="sortSelect">
        <option value="distance">Closest First</option>
        <option value="rating">Highest Rated</option>
        <option value="name">By Name</option>
      </select>
    </div>

    <div class="cafe-list" id="cafeList"
         style="display:grid; grid-template-columns:repeat(auto-fill, minmax(320px,1fr)); gap:25px; margin-bottom:40px;">
      <!-- الكروت ستظهر هنا ديناميكياً -->
    </div>
  </section>

  <style>
    /* =============================
       🎴 كروت المقاهي
    ============================== */
    .cafe-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      overflow: hidden;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      opacity: 0;
      transform: translateY(30px);
    }
    .cafe-card.show {
      opacity: 1;
      transform: translateY(0);
      transition: all 0.6s ease;
    }
    .cafe-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.5);
      border-color: var(--neon-blue);
    }

    .cafe-image {
      height: 200px;
      background: linear-gradient(135deg, var(--coffee-light), var(--coffee-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .cafe-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
    .cafe-card:hover .cafe-image img {
      transform: scale(1.1);
    }

    .cafe-info {
      padding: 20px;
    }
    .cafe-name {
      font-weight: 800;
      font-size: 1.3rem;
      margin-bottom: 10px;
      color: var(--text-primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .cafe-meta {
      display: flex;
      gap: 15px;
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }
    .rating { color: var(--warning); font-weight: bold; }

    .cafe-features {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
    }
    .feature-tag {
      font-size: 0.85rem;
      padding: 5px 12px;
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.2);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .feature-tag.wifi {
      background: rgba(24,220,255,0.15);
      color: var(--neon-blue);
    }
    .feature-tag.outdoor {
      background: rgba(255,209,102,0.15);
      color: var(--warning);
    }
    .feature-tag.parking {
      background: rgba(0,255,140,0.15);
      color: var(--success);
    }
    .feature-tag.snacks {
      background: rgba(255,77,141,0.15);
      color: var(--neon-pink);
    }

    .cafe-actions {
      display: flex;
      gap: 10px;
    }
    .action-btn {
      flex: 1;
      padding: 10px 16px;
      border-radius: 10px;
      font-weight: 700;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.3s;
    }
    .action-btn.directions {
      background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
      color: white;
    }
    .action-btn.details {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
    }
    .action-btn.favorite {
      background: rgba(255,77,141,0.15);
      color: var(--neon-pink);
      border: 1px solid rgba(255,77,141,0.4);
    }
    .action-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
  </style>

  <script>
    // =============================
    // 🎲 بيانات تجريبية للمقاهي
    // =============================
    const cafeData = [
      {
        name: "Arabica Coffee",
        address: "Al Malaz, Riyadh",
        lat: 24.7136, lng: 46.6753,
        rating: 4.5,
        distance: 1.2,
        open: true,
        features: ["wifi", "outdoor"],
        image: "https://images.unsplash.com/photo-1554118811-1e0d58224f24"
      },
      {
        name: "Starbucks Riyadh",
        address: "Sulimaniyah, Riyadh",
        lat: 24.7612, lng: 46.6753,
        rating: 4.7,
        distance: 0.8,
        open: true,
        features: ["wifi", "parking"],
        image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93"
      },
      {
        name: "Deem Coffee",
        address: "Al Olaya, Riyadh",
        lat: 24.6932, lng: 46.6915,
        rating: 4.3,
        distance: 2.3,
        open: true,
        features: ["outdoor", "snacks"],
        image: "https://images.unsplash.com/photo-1463797221720-6b07e6426c24"
      }
    ];

    // =============================
    // 🖼️ عرض بطاقات المقاهي
    // =============================
    function renderCafeList() {
      const cafeList = document.getElementById("cafeList");
      cafeList.innerHTML = "";
      document.getElementById("resultsNumber").textContent = cafeData.length;

      cafeData.forEach((cafe, index) => {
        const card = document.createElement("div");
        card.className = "cafe-card";
        card.innerHTML = `
          <div class="cafe-image">
            <img src="${cafe.image}" alt="${cafe.name}">
          </div>
          <div class="cafe-info">
            <h3 class="cafe-name">${cafe.name}
              <span class="rating"><i class="fas fa-star"></i> ${cafe.rating}</span>
            </h3>
            <div class="cafe-meta">
              <span><i class="fas fa-map-marker-alt"></i> ${cafe.address}</span>
              <span><i class="fas fa-road"></i> ${cafe.distance} km</span>
              <span><i class="fas fa-clock"></i> ${cafe.open ? "Open" : "Closed"}</span>
            </div>
            <div class="cafe-features">
              ${cafe.features.includes("wifi") ? `<span class="feature-tag wifi"><i class="fas fa-wifi"></i> Wi-Fi</span>` : ""}
              ${cafe.features.includes("outdoor") ? `<span class="feature-tag outdoor"><i class="fas fa-umbrella-beach"></i> Outdoor</span>` : ""}
              ${cafe.features.includes("parking") ? `<span class="feature-tag parking"><i class="fas fa-car"></i> Parking</span>` : ""}
              ${cafe.features.includes("snacks") ? `<span class="feature-tag snacks"><i class="fas fa-utensils"></i> Snacks</span>` : ""}
            </div>
            <div class="cafe-actions">
              <button class="action-btn directions"><i class="fas fa-route"></i> Directions</button>
              <button class="action-btn details"><i class="fas fa-info-circle"></i> Details</button>
              <button class="action-btn favorite"><i class="fas fa-heart"></i> Favorite</button>
            </div>
          </div>
        `;
        cafeList.appendChild(card);

        // انيميشن الظهور
        setTimeout(() => card.classList.add("show"), index * 150);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderCafeList();
    });
  </script>
  <!-- 🤖 Chatbot -->
  <div class="chatbot-container" style="position:fixed; bottom:30px; left:30px; z-index:1000;">
    <button class="chatbot-toggle" id="chatbotToggle"
            style="width:60px; height:60px; border-radius:50%; background:linear-gradient(135deg,var(--neon-pink),var(--space-purple));
                   color:white; border:none; font-size:24px; box-shadow:0 4px 20px rgba(255,77,141,0.4);">
      <i class="fas fa-robot"></i>
    </button>
    <div class="chatbot-window" id="chatbotWindow"
         style="display:none; flex-direction:column; position:absolute; bottom:70px; left:0; width:350px; height:450px;
                background:var(--card-bg); border:1px solid var(--border-color); border-radius:16px; box-shadow:0 4px 20px rgba(0,0,0,0.5);">
      <div class="chatbot-header d-flex justify-content-between align-items-center p-2"
           style="background:var(--bg-secondary); border-bottom:1px solid var(--border-color);">
        <h5 class="m-0">Coffee Assistant</h5>
        <button class="btn-close" id="closeChatbot"></button>
      </div>
      <div class="chatbot-messages flex-grow-1 p-3" id="chatbotMessages"
           style="overflow-y:auto; display:flex; flex-direction:column; gap:10px;"></div>
      <div class="chatbot-input d-flex p-2" style="border-top:1px solid var(--border-color); gap:8px;">
        <input type="text" id="chatbotInput" placeholder="Type here..."
               style="flex:1; border-radius:20px; border:1px solid var(--border-color); padding:8px 12px;">
        <button id="sendMessage"
                style="width:45px; height:45px; border-radius:50%; border:none;
                       background:linear-gradient(135deg,var(--neon-blue),var(--space-purple)); color:white;">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- 🔔 إشعارات -->
  <div id="notifications"></div>
  <style>
    #notifications {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 2000;
    }
    .notification {
      padding: 12px 18px;
      border-radius: 10px;
      font-weight: 600;
      color: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      animation: slideIn 0.4s ease;
    }
    @keyframes slideIn {
      from { transform: translateX(120%); opacity:0; }
      to   { transform: translateX(0); opacity:1; }
    }
    .notification.success { background:linear-gradient(135deg,#00ff8c,#00b36b); }
    .notification.error   { background:linear-gradient(135deg,#ff6b6b,#cc5555); }
    .notification.info    { background:linear-gradient(135deg,#18dcff,#7158e2); }
  </style>

  <script>
    // =============================
    // 🔔 إشعارات
    // =============================
    function showNotification(message, type="info") {
      const container = document.getElementById("notifications");
      const n = document.createElement("div");
      n.className = `notification ${type}`;
      n.textContent = message;
      container.appendChild(n);
      setTimeout(()=> { n.style.opacity=0; setTimeout(()=>n.remove(),500); }, 3000);
    }

    // =============================
    // 🤖 Chatbot
    // =============================
    function addChatMessage(text, sender="bot") {
      const messages = document.getElementById("chatbotMessages");
      const div = document.createElement("div");
      div.className = "message " + sender;
      div.style.cssText = `
        padding:10px 15px;
        border-radius:15px;
        max-width:80%;
        line-height:1.4;
      `;
      if(sender==="bot"){
        div.style.background="var(--bg-secondary)";
        div.style.alignSelf="flex-start";
        div.style.color="var(--text-primary)";
      } else {
        div.style.background="linear-gradient(135deg,var(--neon-blue),var(--space-purple))";
        div.style.color="white";
        div.style.alignSelf="flex-end";
      }
      div.textContent = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    const botResponses = [
      "Hello! How can I help you find coffee?",
      "Looking for Wi-Fi or outdoor seating?",
      "I can recommend top rated cafes nearby.",
      "Would you like espresso or latte style places?",
      "Searching... give me a second!"
    ];

    document.getElementById("chatbotToggle").addEventListener("click", ()=>{
      const w = document.getElementById("chatbotWindow");
      w.style.display = w.style.display==="flex" ? "none":"flex";
    });
    document.getElementById("closeChatbot").addEventListener("click", ()=>{
      document.getElementById("chatbotWindow").style.display="none";
    });
    document.getElementById("sendMessage").addEventListener("click", ()=>{
      const input = document.getElementById("chatbotInput");
      const msg = input.value.trim();
      if(!msg) return;
      addChatMessage(msg,"user");
      input.value="";
      setTimeout(()=>{
        const r = botResponses[Math.floor(Math.random()*botResponses.length)];
        addChatMessage(r,"bot");
      },800);
    });

    // =============================
    // 🎮 Gamification + Confetti
    // =============================
    let points = 0;
    function addPoints(p=10) {
      points += p;
      if(points % 50 === 0) {
        showNotification(`Level Up! 🌟 You now have ${points} points!`,"success");
        launchConfetti();
      } else {
        showNotification(`+${p} points! Total: ${points}`,"info");
      }
    }

    function launchConfetti() {
      const duration = 2 * 1000;
      const end = Date.now() + duration;
      (function frame() {
        const confetti = document.createElement("div");
        confetti.style.position="fixed";
        confetti.style.left=Math.random()*100+"vw";
        confetti.style.top="0px";
        confetti.style.width="10px";
        confetti.style.height="10px";
        confetti.style.borderRadius="50%";
        confetti.style.background=`hsl(${Math.random()*360},100%,50%)`;
        confetti.style.opacity=0.8;
        confetti.style.zIndex=3000;
        document.body.appendChild(confetti);
        const fall = setInterval(()=>{
          const top = parseFloat(confetti.style.top);
          if(top > window.innerHeight) { confetti.remove(); clearInterval(fall);}
          confetti.style.top = top+5+"px";
        },30);
        if(Date.now()<end) requestAnimationFrame(frame);
      })();
    }

    // ربط المفضلة مع النقاط
    document.addEventListener("click",(e)=>{
      if(e.target.closest(".action-btn.favorite")){
        addPoints(20);
        showNotification("Added to favorites ❤️","success");
      }
    });
  </script>

  <!-- 🌌 مؤثرات إضافية -->
  <style>
    .neon-text {
      text-shadow: 0 0 5px var(--neon-blue),
                   0 0 10px var(--neon-pink),
                   0 0 15px var(--neon-blue),
                   0 0 20px var(--space-purple);
    }
    .glitch {
      position: relative;
      color: white;
      font-size: 2rem;
      font-weight: bold;
    }
    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      left: 0; top: 0;
      width: 100%; overflow: hidden;
    }
    .glitch::before {
      left: 2px; text-shadow: -2px 0 red; animation: glitch 2s infinite linear alternate-reverse;
    }
    .glitch::after {
      left: -2px; text-shadow: -2px 0 blue; animation: glitch 1.5s infinite linear alternate-reverse;
    }
    @keyframes glitch {
      0% { clip: rect(44px,9999px,56px,0); }
      20% { clip: rect(12px,9999px,80px,0); }
      40% { clip: rect(85px,9999px,140px,0); }
      60% { clip: rect(24px,9999px,70px,0); }
      80% { clip: rect(50px,9999px,90px,0); }
      100% { clip: rect(10px,9999px,130px,0); }
    }
  </style>
  <!-- 🌡️ الطقس -->
  <section class="weather-widget container mb-4 p-3"
           style="background:var(--card-bg); border-radius:12px; border:1px solid var(--border-color); max-width:400px;">
    <h4><i class="fas fa-cloud-sun"></i> Weather</h4>
    <p id="weatherInfo">Select a city to see the weather...</p>
  </section>

  <!-- ⚡ شريط الطاقة -->
  <div class="energy-bar" style="position:fixed; top:0; left:0; width:0%; height:5px; 
       background:linear-gradient(90deg,var(--neon-blue),var(--neon-pink)); z-index:3000;"></div>

  <!-- 🌐 مبدل اللغة -->
  <div class="language-switcher" style="position:fixed; top:20px; right:20px; z-index:2000;">
    <button id="langToggle"
            style="padding:8px 14px; border:none; border-radius:20px; background:rgba(255,255,255,0.2);
                   color:white; cursor:pointer; backdrop-filter:blur(10px);">
      العربية
    </button>
  </div>

  <script>
    // =============================
    // 🌡️ الطقس (OpenWeatherMap API مجاني)
    // =============================
    async function getWeather(city="Riyadh") {
      try {
        const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=24.7&longitude=46.7&current_weather=true`);
        const data = await res.json();
        const temp = data.current_weather.temperature;
        const wind = data.current_weather.windspeed;
        document.getElementById("weatherInfo").textContent = `Temp: ${temp}°C | Wind: ${wind} km/h`;
      } catch (err) {
        document.getElementById("weatherInfo").textContent = "Weather unavailable.";
      }
    }
    getWeather();

    // =============================
    // 🗺️ البحث (Nominatim + Overpass)
    // =============================
    async function searchCity(query) {
      try {
        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${query}, Saudi Arabia`;
        const res = await fetch(url);
        const data = await res.json();
        if(data && data.length>0){
          const {lat, lon, display_name} = data[0];
          map.setView([lat,lon], 13);
          showNotification(`Found ${display_name}`,"success");
          getWeather(display_name);
          fetchCafes(lat,lon);
        } else {
          showNotification("City not found","error");
        }
      } catch(err){
        showNotification("Search error","error");
      }
    }

    async function fetchCafes(lat,lon){
      const overpassUrl = "https://overpass-api.de/api/interpreter";
      const radius = document.getElementById("radius").value || 3000;
      const query = `
        [out:json];
        (
          node["amenity"="cafe"](around:${radius},${lat},${lon});
        );
        out;
      `;
      try {
        const res = await fetch(overpassUrl, {method:"POST", body:query});
        const data = await res.json();
        cafeData.length = 0; // clear
        data.elements.forEach(el=>{
          cafeData.push({
            name: el.tags.name || "Unnamed Cafe",
            address: el.tags["addr:street"] || "Unknown",
            lat: el.lat,
            lng: el.lon,
            rating: (Math.random()*2+3).toFixed(1),
            distance: Math.floor(Math.random()*5)+1,
            open: Math.random()>0.3,
            features: ["wifi","outdoor","snacks"].filter(()=>Math.random()>0.5),
            image: "https://source.unsplash.com/400x300/?coffee,cafe"
          });
        });
        renderCafeList();
        showNotification(`Loaded ${cafeData.length} cafes`,"success");
      } catch(err){
        showNotification("Failed to load cafes","error");
      }
    }

    // ربط زر البحث
    document.getElementById("searchBtn").addEventListener("click",()=>{
      const q = document.getElementById("searchInput").value.trim();
      if(q) searchCity(q);
    });
    document.getElementById("searchInput").addEventListener("keypress",(e)=>{
      if(e.key==="Enter"){
        const q = document.getElementById("searchInput").value.trim();
        if(q) searchCity(q);
      }
    });

    // =============================
    // ⚡ شريط الطاقة
    // =============================
    window.addEventListener("scroll",()=>{
      const h = document.documentElement;
      const st = h.scrollTop;
      const sh = h.scrollHeight - h.clientHeight;
      const p = (st/sh)*100;
      document.querySelector(".energy-bar").style.width = p+"%";
    });

    // =============================
    // 🌐 تعدد اللغات
    // =============================
    let lang="en";
    document.getElementById("langToggle").addEventListener("click",()=>{
      lang = (lang==="en"?"ar":"en");
      if(lang==="ar"){
        document.body.dir="rtl";
        document.getElementById("langToggle").textContent="English";
        showNotification("تم التبديل إلى العربية","info");
      } else {
        document.body.dir="ltr";
        document.getElementById("langToggle").textContent="العربية";
        showNotification("Language switched to English","info");
      }
    });

    // =============================
    // 📤 مشاركة + QR
    // =============================
    function shareCafe(cafe){
      const url = `https://www.google.com/maps?q=${cafe.lat},${cafe.lng}`;
      if(navigator.share){
        navigator.share({title:cafe.name, text:"Check this cafe!", url});
      } else {
        prompt("Copy this link:",url);
      }
    }

    function generateQR(cafe){
      const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(cafe.name+" "+cafe.lat+","+cafe.lng)}`;
      const w = window.open("","_blank","width=200,height=200");
      w.document.write(`<img src="${qrUrl}" alt="QR Code">`);
    }

    // تحديث البطاقات لاضافة زر مشاركة و QR
    function renderCafeList(){
      const cafeList = document.getElementById("cafeList");
      cafeList.innerHTML="";
      document.getElementById("resultsNumber").textContent=cafeData.length;
      cafeData.forEach((cafe,index)=>{
        const card = document.createElement("div");
        card.className="cafe-card";
        card.innerHTML=`
          <div class="cafe-image"><img src="${cafe.image}" alt="${cafe.name}"></div>
          <div class="cafe-info">
            <h3 class="cafe-name">${cafe.name}<span class="rating"><i class="fas fa-star"></i> ${cafe.rating}</span></h3>
            <div class="cafe-meta">
              <span><i class="fas fa-map-marker-alt"></i> ${cafe.address}</span>
              <span><i class="fas fa-road"></i> ${cafe.distance} km</span>
              <span><i class="fas fa-clock"></i> ${cafe.open?"Open":"Closed"}</span>
            </div>
            <div class="cafe-features">
              ${cafe.features.map(f=>`<span class="feature-tag ${f}">${f}</span>`).join("")}
            </div>
            <div class="cafe-actions">
              <button class="action-btn directions" onclick="window.open('https://www.google.com/maps?q=${cafe.lat},${cafe.lng}','_blank')"><i class="fas fa-route"></i> Directions</button>
              <button class="action-btn details" onclick="alert('Details about ${cafe.name}')"><i class="fas fa-info-circle"></i> Details</button>
              <button class="action-btn favorite"><i class="fas fa-heart"></i> Favorite</button>
              <button class="action-btn" onclick='shareCafe(${JSON.stringify(cafe)})'><i class="fas fa-share"></i> Share</button>
              <button class="action-btn" onclick='generateQR(${JSON.stringify(cafe)})'><i class="fas fa-qrcode"></i> QR</button>
            </div>
          </div>
        `;
        cafeList.appendChild(card);
        setTimeout(()=>card.classList.add("show"),index*100);
      });
    }

    // =============================
    // 📂 Offline Mode
    // =============================
    window.addEventListener("offline",()=>{
      showNotification("⚠️ You are offline!","error");
    });
    window.addEventListener("online",()=>{
      showNotification("✅ Back online!","success");
    });

    // =============================
    // 🎮 Easter Egg
    // =============================
    document.addEventListener("keydown",(e)=>{
      if(e.ctrlKey && e.shiftKey && e.code==="KeyC"){
        const egg=document.createElement("div");
        egg.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:black;color:lime;font-size:2rem;display:flex;align-items:center;justify-content:center;z-index:5000;";
        egg.textContent="☕ The Coffee Matrix has you... ☕";
        document.body.appendChild(egg);
        setTimeout(()=>egg.remove(),4000);
      }
    });
  </script>

  <!-- =============================
       👣 Footer
  ============================== -->
  <footer class="text-center p-4 mt-5" style="color:var(--text-secondary); border-top:1px solid var(--border-color);">
    <p>© 2025 Coffee Finder Pro — Sci-Fi Edition</p>
    <p>Discover the best coffee shops across Saudi Arabia</p>
  </footer>

  <!-- مكتبات JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
</html>
<!-- ====================== PART 5 START ====================== -->
<!-- Cosmic Background + Music Player + Dashboard + Coffee Game -->

<!-- Cosmic Stars Background -->
<canvas id="starsCanvas"></canvas>

<!-- Background Music Player -->
<div class="music-player" id="musicPlayer">
  <button id="playMusic"><i class="fas fa-play"></i></button>
  <button id="pauseMusic"><i class="fas fa-pause"></i></button>
  <button id="nextMusic"><i class="fas fa-forward"></i></button>
  <span id="musicTitle">🎶 Background Music</span>
</div>

<!-- Dashboard Section -->
<section class="dashboard">
  <h2 class="dashboard-title">📊 Coffee Finder Stats</h2>
  <div class="dashboard-grid">
    <div class="dashboard-card">
      <h3 id="statsCafes">0</h3>
      <p>Total Cafes</p>
    </div>
    <div class="dashboard-card">
      <h3 id="statsUsers">0</h3>
      <p>Active Users</p>
    </div>
    <div class="dashboard-card">
      <h3 id="statsVisits">0</h3>
      <p>Visits Today</p>
    </div>
    <div class="dashboard-card">
      <h3 id="statsGames">0</h3>
      <p>Games Played</p>
    </div>
  </div>
</section>

<!-- Coffee Game -->
<section class="coffee-game">
  <h2 class="game-title">☕ Coffee Beans Game</h2>
  <canvas id="gameCanvas" width="600" height="400"></canvas>
  <div class="game-controls">
    <button id="startGame">Start Game</button>
    <p>Score: <span id="gameScore">0</span></p>
  </div>
</section>

<style>
/* Stars Background */
#starsCanvas {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  z-index: -2;
  background: #000;
}

/* Music Player */
.music-player {
  position: fixed;
  bottom: 100px; left: 30px;
  background: rgba(20,20,30,0.8);
  padding: 12px 18px;
  border-radius: 12px;
  display: flex; align-items: center;
  gap: 10px;
  color: white;
  box-shadow: 0 0 15px rgba(255,255,255,0.2);
}
.music-player button {
  background: transparent;
  border: none; color: #18dcff;
  font-size: 20px; cursor: pointer;
  transition: transform 0.2s;
}
.music-player button:hover { transform: scale(1.2); }
#musicTitle { font-size: 0.9rem; }

/* Dashboard */
.dashboard {
  margin: 60px 0;
  padding: 20px;
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: var(--shadow);
}
.dashboard-title {
  text-align: center;
  margin-bottom: 25px;
  color: var(--neon-blue);
}
.dashboard-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill,minmax(200px,1fr));
  gap: 20px;
}
.dashboard-card {
  background: var(--bg-secondary);
  padding: 20px;
  text-align: center;
  border-radius: 12px;
  box-shadow: var(--shadow);
}
.dashboard-card h3 { font-size: 2rem; color: var(--neon-pink); }

/* Coffee Game */
.coffee-game {
  margin: 60px 0;
  padding: 20px;
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: var(--shadow);
  text-align: center;
}
#gameCanvas {
  border: 2px solid var(--border-color);
  border-radius: 12px;
  background: #1b1b2f;
  display: block;
  margin: 0 auto;
}
.game-controls {
  margin-top: 15px;
}
.game-controls button {
  padding: 10px 20px;
  border-radius: 8px;
  border: none;
  background: linear-gradient(135deg,#18dcff,#7158e2);
  color: white; font-weight: bold;
  cursor: pointer;
}
.game-controls button:hover { opacity: 0.8; }
</style>

<script>
// ================= Stars Background =================
const canvas = document.getElementById("starsCanvas");
const ctx = canvas.getContext("2d");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let stars = [];
for (let i=0;i<150;i++){
  stars.push({
    x: Math.random()*canvas.width,
    y: Math.random()*canvas.height,
    radius: Math.random()*1.5,
    speed: Math.random()*0.5+0.2
  });
}
function animateStars(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="white";
  stars.forEach(star=>{
    ctx.beginPath();
    ctx.arc(star.x,star.y,star.radius,0,Math.PI*2);
    ctx.fill();
    star.y += star.speed;
    if(star.y>canvas.height){ star.y=0; star.x=Math.random()*canvas.width; }
  });
  requestAnimationFrame(animateStars);
}
animateStars();

// ================= Music Player =================
const songs = [
  "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3",
  "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-2.mp3",
  "https://www.soundhelix.com/examples/mp3/SoundHelix-Song-3.mp3"
];
let currentSong = 0;
const audio = new Audio(songs[currentSong]);
document.getElementById("playMusic").onclick=()=>audio.play();
document.getElementById("pauseMusic").onclick=()=>audio.pause();
document.getElementById("nextMusic").onclick=()=>{
  currentSong=(currentSong+1)%songs.length;
  audio.src=songs[currentSong];
  audio.play();
};
document.getElementById("musicTitle").textContent="🎶 Free Cosmic Beats";

// ================= Dashboard Stats =================
let cafes=12,users=523,visits=87,games=0;
function updateStats(){
  document.getElementById("statsCafes").textContent=cafes;
  document.getElementById("statsUsers").textContent=users;
  document.getElementById("statsVisits").textContent=visits;
  document.getElementById("statsGames").textContent=games;
}
setInterval(()=>{
  visits+=Math.floor(Math.random()*3);
  users+=Math.floor(Math.random()*2);
  updateStats();
},3000);
updateStats();

// ================= Coffee Game =================
const gameCanvas=document.getElementById("gameCanvas");
const gctx=gameCanvas.getContext("2d");
let player={x:280,y:350,w:40,h:40,color:"#18dcff"};
let beans=[],score=0,gameRunning=false;

function spawnBean(){
  beans.push({x:Math.random()*560,y:0,w:20,h:20,speed:2+Math.random()*2});
}
function drawPlayer(){
  gctx.fillStyle=player.color;
  gctx.fillRect(player.x,player.y,player.w,player.h);
}
function drawBeans(){
  beans.forEach(bean=>{
    gctx.fillStyle="#ffdd57";
    gctx.beginPath();
    gctx.arc(bean.x,bean.y,bean.w/2,0,Math.PI*2);
    gctx.fill();
  });
}
function updateBeans(){
  beans.forEach((bean,i)=>{
    bean.y+=bean.speed;
    if(bean.y>400) beans.splice(i,1);
    if(bean.x<player.x+player.w && bean.x+bean.w>player.x &&
       bean.y<player.y+player.h && bean.y+bean.h>player.y){
      beans.splice(i,1); score+=10;
      document.getElementById("gameScore").textContent=score;
    }
  });
}
function gameLoop(){
  if(!gameRunning) return;
  gctx.clearRect(0,0,600,400);
  drawPlayer();
  drawBeans();
  updateBeans();
  requestAnimationFrame(gameLoop);
}
document.getElementById("startGame").onclick=()=>{
  score=0; beans=[]; gameRunning=true; games++;
  setInterval(spawnBean,1000);
  gameLoop();
  updateStats();
};
document.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft" && player.x>0) player.x-=20;
  if(e.key==="ArrowRight" && player.x<560) player.x+=20;
});
</script>
<!-- ====================== PART 5 END ====================== -->
<!-- ====================== PART 6 START ====================== -->
<!-- Advanced Chatbot + Parallax + Dynamic Background + Coffee Store + Achievements -->

<!-- Dynamic Background -->
<div id="dynamicBackground"></div>

<!-- Coffee Store -->
<section class="coffee-store">
  <h2 class="store-title">🛒 Virtual Coffee Store</h2>
  <div class="store-grid">
    <div class="store-card">
      <img src="https://images.unsplash.com/photo-1510626176961-4b37d0adf1f4" alt="Latte">
      <h3>Latte</h3>
      <p>Rich espresso with steamed milk.</p>
      <button onclick="buyItem('Latte')">Buy Now</button>
    </div>
    <div class="store-card">
      <img src="https://images.unsplash.com/photo-1527169402691-a097c6f1b9ad" alt="Cappuccino">
      <h3>Cappuccino</h3>
      <p>Espresso topped with foam.</p>
      <button onclick="buyItem('Cappuccino')">Buy Now</button>
    </div>
    <div class="store-card">
      <img src="https://images.unsplash.com/photo-1498804103079-a6351b050096" alt="Mocha">
      <h3>Mocha</h3>
      <p>Chocolate + Espresso + Milk.</p>
      <button onclick="buyItem('Mocha')">Buy Now</button>
    </div>
    <div class="store-card">
      <img src="https://images.unsplash.com/photo-1559628233-9445d0b51f5e" alt="Cold Brew">
      <h3>Cold Brew</h3>
      <p>Slow-brewed over 12 hours.</p>
      <button onclick="buyItem('Cold Brew')">Buy Now</button>
    </div>
  </div>
</section>

<!-- Achievements -->
<section class="achievements">
  <h2 class="achievements-title">🏆 Your Achievements</h2>
  <div class="achievements-grid">
    <div class="achievement" id="ach1">First Search 🔍</div>
    <div class="achievement" id="ach2">Coffee Lover ☕</div>
    <div class="achievement" id="ach3">Explorer 🌍</div>
    <div class="achievement" id="ach4">Game Master 🎮</div>
  </div>
</section>

<!-- Parallax Section -->
<section class="parallax-section">
  <div class="parallax-content">
    <h2>Feel the Coffee Vibes</h2>
    <p>Scroll down to enjoy the parallax effect and immersive design.</p>
  </div>
</section>

<!-- Upgraded Chatbot -->
<div class="chatbot-advanced" id="chatbotAdvanced">
  <div class="chat-header">
    <h4>AI Coffee Assistant 🤖</h4>
    <button id="closeAdvChat">×</button>
  </div>
  <div class="chat-body" id="chatBody"></div>
  <div class="chat-input">
    <input type="text" id="chatInput" placeholder="Ask me anything about coffee...">
    <button id="sendChat"><i class="fas fa-paper-plane"></i></button>
  </div>
</div>
<button class="chat-open" id="openAdvChat"><i class="fas fa-comments"></i></button>

<style>
/* Dynamic Background */
#dynamicBackground {
  position: fixed; top:0; left:0;
  width:100%; height:100%;
  z-index:-3;
  background: linear-gradient(to bottom, #ffe29f, #ffa99f);
  transition: background 1s ease;
}

/* Store */
.coffee-store {
  padding: 40px;
  background: var(--card-bg);
  border-radius: 16px;
  margin: 50px 0;
}
.store-title { text-align:center; margin-bottom:20px; color:var(--neon-blue);}
.store-grid {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(220px,1fr));
  gap:20px;
}
.store-card {
  background: var(--bg-secondary);
  padding:15px; border-radius:12px;
  text-align:center;
  box-shadow: var(--shadow);
}
.store-card img {
  width:100%; height:150px; object-fit:cover;
  border-radius:10px;
}
.store-card h3 { margin:10px 0; }
.store-card button {
  padding:8px 15px;
  border:none; border-radius:8px;
  background:linear-gradient(135deg,#18dcff,#7158e2);
  color:white; font-weight:bold; cursor:pointer;
}

/* Achievements */
.achievements { margin:60px 0; padding:20px; background:var(--card-bg); border-radius:16px; }
.achievements-title { text-align:center; margin-bottom:20px; color:var(--neon-pink);}
.achievements-grid {
  display:grid; grid-template-columns: repeat(auto-fill,minmax(180px,1fr));
  gap:15px;
}
.achievement {
  background:var(--bg-secondary);
  padding:15px;
  border-radius:12px;
  text-align:center;
  font-weight:bold;
  opacity:0.5;
  transition:all 0.3s;
}
.achievement.unlocked {
  background:linear-gradient(135deg,#00ff8c,#18dcff);
  color:#000;
  opacity:1;
  box-shadow:0 0 15px rgba(0,255,140,0.6);
}

/* Parallax */
.parallax-section {
  background:url('https://images.unsplash.com/photo-1509042239860-f550ce710b93') center/cover fixed;
  color:white;
  text-align:center;
  padding:120px 20px;
  border-radius:16px;
  margin:50px 0;
}
.parallax-content h2 { font-size:2.5rem; text-shadow:0 0 10px #000; }

/* Advanced Chatbot */
.chatbot-advanced {
  position:fixed; bottom:20px; right:20px;
  width:350px; height:450px;
  background:var(--card-bg);
  border-radius:16px;
  box-shadow:var(--shadow);
  display:none; flex-direction:column;
}
.chat-header {
  padding:15px;
  background:var(--bg-secondary);
  border-bottom:1px solid var(--border-color);
  display:flex; justify-content:space-between; align-items:center;
}
.chat-body {
  flex:1; padding:15px; overflow-y:auto; display:flex; flex-direction:column; gap:10px;
}
.chat-body .msg { padding:10px; border-radius:12px; max-width:80%; }
.chat-body .bot { background:var(--bg-secondary); align-self:flex-start; }
.chat-body .user { background:linear-gradient(135deg,#18dcff,#7158e2); color:white; align-self:flex-end; }
.chat-input { padding:10px; display:flex; gap:10px; border-top:1px solid var(--border-color);}
.chat-input input { flex:1; border:1px solid var(--border-color); border-radius:20px; padding:8px 12px;}
.chat-input button { border:none; border-radius:50%; width:40px; height:40px; background:linear-gradient(135deg,#18dcff,#7158e2); color:white; cursor:pointer;}
.chat-open {
  position:fixed; bottom:20px; right:20px;
  width:60px; height:60px; border-radius:50%;
  background:linear-gradient(135deg,#ff4d8d,#7158e2);
  color:white; border:none; font-size:22px;
  display:flex; align-items:center; justify-content:center;
  cursor:pointer; box-shadow:0 4px 20px rgba(0,0,0,0.3);
}
</style>

<script>
// ========== Dynamic Background ==========
function setDynamicBackground(){
  const hour=new Date().getHours();
  const bg=document.getElementById("dynamicBackground");
  if(hour>=6 && hour<12) bg.style.background="linear-gradient(to bottom,#ffe29f,#ffa99f)"; // Morning
  else if(hour>=12 && hour<18) bg.style.background="linear-gradient(to bottom,#a1c4fd,#c2e9fb)"; // Day
  else if(hour>=18 && hour<21) bg.style.background="linear-gradient(to bottom,#fbc2eb,#a6c1ee)"; // Evening
  else bg.style.background="linear-gradient(to bottom,#0f2027,#2c5364)"; // Night
}
setDynamicBackground();
setInterval(setDynamicBackground,60000);

// ========== Store ==========
function buyItem(item){
  showNotification("Purchased "+item+" successfully!","success");
  unlockAchievement("ach2");
}

// ========== Achievements ==========
function unlockAchievement(id){
  const el=document.getElementById(id);
  if(el && !el.classList.contains("unlocked")){
    el.classList.add("unlocked");
    showNotification("Achievement unlocked: "+el.textContent,"success");
  }
}
document.getElementById("searchBtn").addEventListener("click",()=>unlockAchievement("ach1"));
document.getElementById("startGame").addEventListener("click",()=>unlockAchievement("ach4"));

// ========== Advanced Chatbot ==========
const advChat=document.getElementById("chatbotAdvanced");
document.getElementById("openAdvChat").onclick=()=>advChat.style.display="flex";
document.getElementById("closeAdvChat").onclick=()=>advChat.style.display="none";

function addMsg(text,sender){
  const body=document.getElementById("chatBody");
  const div=document.createElement("div");
  div.className="msg "+sender;
  div.textContent=text;
  body.appendChild(div);
  body.scrollTop=body.scrollHeight;
}

document.getElementById("sendChat").onclick=()=>{
  const input=document.getElementById("chatInput");
  const text=input.value.trim();
  if(!text) return;
  addMsg(text,"user");
  input.value="";
  setTimeout(()=>{
    const replies=[
      "☕ Did you know? Arabic coffee is often flavored with cardamom!",
      "Try a Mocha if you love chocolate 🍫",
      "The best time for coffee is mid-morning around 10am ⏰",
      "Cold brew has less acidity and smoother taste ❄️",
      "Espresso is the base for most coffee drinks 🔥"
    ];
    const reply=replies[Math.floor(Math.random()*replies.length)];
    addMsg(reply,"bot");
  },1000);
};
</script>
<!-- ====================== PART 6 END ====================== -->
<!-- ====================== PART 7 START ====================== -->
<!-- Theme Generator + Heatmap + Video Background + Events + Compass + Sticky Notes -->

<!-- Video Background -->
<video autoplay muted loop id="videoBackground">
  <source src="https://cdn.coverr.co/videos/coverr-coffee-beans-8177/1080p.mp4" type="video/mp4">
</video>

<!-- Theme Generator -->
<section class="theme-generator">
  <h2>🎨 Theme Generator</h2>
  <p>Pick your favorite colors to customize the site:</p>
  <label>Primary Color <input type="color" id="primaryColor" value="#734f35"></label>
  <label>Secondary Color <input type="color" id="secondaryColor" value="#7158e2"></label>
  <label>Accent Color <input type="color" id="accentColor" value="#18dcff"></label>
  <button id="applyTheme">Apply Theme</button>
</section>

<!-- Heatmap -->
<section class="heatmap-section">
  <h2>🌍 Coffee Heatmap</h2>
  <div id="heatmapMap" style="height:400px; border-radius:16px;"></div>
</section>

<!-- Events Calendar -->
<section class="events-calendar">
  <h2>📅 Coffee Events Calendar</h2>
  <div id="calendar"></div>
</section>

<!-- Compass -->
<div id="compassContainer">
  <div id="compass">
    <div id="needle"></div>
  </div>
</div>

<!-- Sticky Notes -->
<section class="sticky-notes">
  <h2>📌 Sticky Notes</h2>
  <textarea id="noteInput" placeholder="Write your note..."></textarea>
  <button id="saveNote">Save Note</button>
  <div id="notesList"></div>
</section>

<style>
/* Video Background */
#videoBackground {
  position: fixed; top:0; left:0;
  width:100%; height:100%;
  object-fit: cover;
  z-index:-5;
  opacity:0.25;
}

/* Theme Generator */
.theme-generator {
  padding:30px; margin:50px 0;
  background:var(--card-bg); border-radius:16px; box-shadow:var(--shadow);
}
.theme-generator h2 { margin-bottom:15px; color:var(--neon-blue);}
.theme-generator label { display:block; margin:10px 0; }

/* Heatmap */
.heatmap-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px; }

/* Events Calendar */
.events-calendar { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
#calendar { display:grid; grid-template-columns: repeat(7,1fr); gap:5px; }
#calendar div { padding:15px; background:var(--bg-secondary); text-align:center; border-radius:8px; }
#calendar div.event { background:linear-gradient(135deg,#18dcff,#7158e2); color:white; font-weight:bold; }

/* Compass */
#compassContainer {
  position:fixed; top:20px; left:20px; z-index:2000;
}
#compass {
  width:80px; height:80px; border:4px solid #fff; border-radius:50%;
  position:relative; background:rgba(0,0,0,0.4);
}
#needle {
  width:2px; height:35px; background:red;
  position:absolute; top:5px; left:50%;
  transform-origin: bottom center;
}

/* Sticky Notes */
.sticky-notes {
  margin:50px 0; padding:20px;
  background:var(--card-bg); border-radius:16px;
}
#noteInput { width:100%; height:100px; border-radius:8px; padding:10px; margin-bottom:10px;}
#notesList { display:flex; flex-wrap:wrap; gap:10px; }
.note {
  background:#fff59d; padding:15px; border-radius:10px;
  box-shadow:0 4px 10px rgba(0,0,0,0.2);
  min-width:120px;
}
</style>

<script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

<script>
// ========== Theme Generator ==========
document.getElementById("applyTheme").onclick=()=>{
  document.documentElement.style.setProperty("--primary",document.getElementById("primaryColor").value);
  document.documentElement.style.setProperty("--secondary",document.getElementById("secondaryColor").value);
  document.documentElement.style.setProperty("--accent",document.getElementById("accentColor").value);
  showNotification("Theme updated!","success");
};

// ========== Heatmap ==========
const heatmap=L.map("heatmapMap").setView([24.7136,46.6753],12);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(heatmap);
const heatData=[
  [24.7136,46.6753,0.8],[24.7216,46.6553,0.7],
  [24.7812,46.6912,0.9],[24.7523,46.7001,0.6],
  [24.6932,46.6915,0.5]
];
L.heatLayer(heatData,{radius:25}).addTo(heatmap);

// ========== Events Calendar ==========
function generateCalendar(){
  const cal=document.getElementById("calendar");
  cal.innerHTML="";
  const days=30;
  const events={5:"☕ Latte Festival",12:"🎶 Jazz Night",18:"🍪 Cookies & Coffee",25:"🔥 Barista Show"};
  for(let i=1;i<=days;i++){
    const div=document.createElement("div");
    div.textContent=i;
    if(events[i]){ div.classList.add("event"); div.title=events[i]; }
    cal.appendChild(div);
  }
}
generateCalendar();

// ========== Compass ==========
if(window.DeviceOrientationEvent){
  window.addEventListener("deviceorientation",function(event){
    const alpha=event.alpha;
    document.getElementById("needle").style.transform=`rotate(${alpha}deg)`;
  },true);
}

// ========== Sticky Notes ==========
function loadNotes(){
  const notes=JSON.parse(localStorage.getItem("notes")||"[]");
  const list=document.getElementById("notesList");
  list.innerHTML="";
  notes.forEach((n,i)=>{
    const div=document.createElement("div");
    div.className="note";
    div.textContent=n;
    div.onclick=()=>{
      notes.splice(i,1);
      localStorage.setItem("notes",JSON.stringify(notes));
      loadNotes();
    };
    list.appendChild(div);
  });
}
document.getElementById("saveNote").onclick=()=>{
  const input=document.getElementById("noteInput");
  if(input.value.trim()){
    const notes=JSON.parse(localStorage.getItem("notes")||"[]");
    notes.push(input.value.trim());
    localStorage.setItem("notes",JSON.stringify(notes));
    input.value="";
    loadNotes();
    showNotification("Note saved!","success");
  }
};
loadNotes();
</script>
<!-- ====================== PART 7 END ====================== -->
<!-- ====================== PART 8 START ====================== -->
<!-- 3D Gallery + Mapbox + Charts + Extra Games + TTS + Offline Mode + Sci-Fi Mode -->

<!-- 3D Gallery -->
<section class="gallery">
  <h2>🖼 Coffee 3D Gallery</h2>
  <div class="gallery-carousel" id="galleryCarousel">
    <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93" alt="Coffee 1">
    <img src="https://images.unsplash.com/photo-1527169402691-a097c6f1b9ad" alt="Coffee 2">
    <img src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085" alt="Coffee 3">
    <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24" alt="Coffee 4">
  </div>
</section>

<!-- Mapbox -->
<section class="mapbox-section">
  <h2>🛰 Sci-Fi Map</h2>
  <div id="mapboxMap" style="height:400px; border-radius:16px;"></div>
</section>

<!-- Charts -->
<section class="charts-section">
  <h2>📊 Coffee Stats</h2>
  <canvas id="coffeeChart" width="400" height="200"></canvas>
</section>

<!-- Extra Games -->
<section class="extra-games">
  <h2>🧩 Coffee Games</h2>
  <div class="memory-game" id="memoryGame"></div>
  <div class="quiz">
    <h3>☕ Coffee Quiz</h3>
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
  </div>
</section>

<!-- Text to Speech -->
<section class="tts-section">
  <h2>🎤 Text to Speech</h2>
  <textarea id="ttsInput" placeholder="Write something about coffee..."></textarea>
  <button id="speakBtn">Speak</button>
</section>

<!-- Offline Mode -->
<div id="offlineAlert">⚠️ You are offline. Some features may not work.</div>

<!-- Sci-Fi Mode -->
<button id="sciFiBtn" class="sci-fi-btn">Activate Sci-Fi Mode 🔮</button>

<style>
/* Gallery */
.gallery { margin:50px 0; text-align:center; }
.gallery-carousel { display:flex; gap:20px; overflow-x:auto; padding:20px; }
.gallery-carousel img {
  width:250px; height:180px; object-fit:cover;
  border-radius:12px; transition:transform 0.5s;
}
.gallery-carousel img:hover { transform:rotateY(20deg) scale(1.1); }

/* Mapbox */
.mapbox-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px; }

/* Charts */
.charts-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px; }

/* Memory Game */
.memory-game { display:grid; grid-template-columns: repeat(4,1fr); gap:10px; margin:20px 0; }
.memory-card {
  background:#333; height:80px; border-radius:8px;
  display:flex; align-items:center; justify-content:center;
  color:white; font-size:24px; cursor:pointer;
}
.memory-card.flipped { background:#18dcff; }

/* Quiz */
.quiz { margin-top:20px; }
#quizOptions button {
  display:block; margin:5px 0; padding:10px;
  border:none; border-radius:8px;
  background:#7158e2; color:white; cursor:pointer;
}

/* TTS */
.tts-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
.tts-section textarea { width:100%; height:100px; margin-bottom:10px; padding:10px; }

/* Offline */
#offlineAlert {
  position:fixed; top:0; left:0; right:0;
  background:#ff6b6b; color:white;
  text-align:center; padding:10px;
  display:none; z-index:3000;
}

/* Sci-Fi Button */
.sci-fi-btn {
  position:fixed; bottom:100px; right:30px;
  padding:12px 20px; border:none;
  border-radius:12px;
  background:linear-gradient(135deg,#18dcff,#ff4d8d);
  color:white; font-weight:bold; cursor:pointer;
}
.sci-fi-mode {
  background: radial-gradient(circle at center, #0ff, #000);
  color:#0ff;
}
</style>

<script src="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// ========== Mapbox ==========
mapboxgl.accessToken='pk.eyJ1IjoibWFwYm94dXNlciIsImEiOiJja2xnaWxqdmwwMDRnMm9ucnJ6YnZrNjJwIn0.6D0xLugUVxZ6RVcZ9I8A5g';
const mapboxMap=new mapboxgl.Map({
  container:'mapboxMap',
  style:'mapbox://styles/mapbox/dark-v10',
  center:[46.6753,24.7136], zoom:10
});

// ========== Chart.js ==========
const ctx=document.getElementById("coffeeChart").getContext("2d");
new Chart(ctx,{
  type:"bar",
  data:{
    labels:["Latte","Cappuccino","Mocha","Espresso"],
    datasets:[{
      label:"Orders",
      data:[12,19,7,14],
      backgroundColor:["#18dcff","#ff4d8d","#7158e2","#ffd166"]
    }]
  }
});

// ========== Memory Game ==========
const icons=["☕","🍪","🥐","🍩","🍫","🍵"];
let memoryCards=[...icons,...icons].sort(()=>0.5-Math.random());
const memoryGame=document.getElementById("memoryGame");
let flipped=[],matched=0;
memoryCards.forEach((icon,i)=>{
  const div=document.createElement("div");
  div.className="memory-card";
  div.dataset.icon=icon;
  div.onclick=()=>{
    if(flipped.length<2 && !div.classList.contains("flipped")){
      div.classList.add("flipped"); div.textContent=icon; flipped.push(div);
      if(flipped.length===2){
        if(flipped[0].dataset.icon===flipped[1].dataset.icon){
          matched+=2; flipped=[]; 
          if(matched===memoryCards.length) showNotification("🎉 You won the Memory Game!","success");
        }else{
          setTimeout(()=>{ flipped.forEach(c=>{c.classList.remove("flipped"); c.textContent="";}); flipped=[];},1000);
        }
      }
    }
  };
  memoryGame.appendChild(div);
});

// ========== Quiz ==========
const quizQ=[
  {q:"Which drink has chocolate?",o:["Latte","Mocha","Espresso"],a:1},
  {q:"Which is cold?",o:["Cold Brew","Cappuccino","Espresso"],a:0}
];
let currentQ=0;
function loadQuiz(){
  const q=quizQ[currentQ];
  document.getElementById("quizQuestion").textContent=q.q;
  const opts=document.getElementById("quizOptions"); opts.innerHTML="";
  q.o.forEach((opt,i)=>{
    const btn=document.createElement("button");
    btn.textContent=opt;
    btn.onclick=()=>{
      if(i===q.a){ showNotification("✅ Correct!","success"); }
      else { showNotification("❌ Wrong!","error"); }
      currentQ=(currentQ+1)%quizQ.length; loadQuiz();
    };
    opts.appendChild(btn);
  });
}
loadQuiz();

// ========== TTS ==========
document.getElementById("speakBtn").onclick=()=>{
  const text=document.getElementById("ttsInput").value;
  if(text){
    const utter=new SpeechSynthesisUtterance(text);
    utter.lang="en-US";
    speechSynthesis.speak(utter);
  }
};

// ========== Offline ==========
window.addEventListener("offline",()=>{ document.getElementById("offlineAlert").style.display="block"; });
window.addEventListener("online",()=>{ document.getElementById("offlineAlert").style.display="none"; });

// ========== Sci-Fi Mode ==========
document.getElementById("sciFiBtn").onclick=()=>{
  document.body.classList.toggle("sci-fi-mode");
  if(document.body.classList.contains("sci-fi-mode")){
    showNotification("Sci-Fi Mode Activated 🔮","success");
  }else{
    showNotification("Sci-Fi Mode Deactivated","info");
  }
};
</script>
<!-- ====================== PART 8 END ====================== -->
<!-- ====================== PART 9 START ====================== -->
<!-- AR/VR Mockup + AI Recommender + Leaderboard + Membership + Community Wall + Wiki + Immersive Mode -->

<!-- Animated Gradient Background -->
<div id="animatedGradient"></div>

<!-- AR/VR Mockup -->
<section class="ar-vr">
  <h2>🕶 Virtual Coffee Experience</h2>
  <div class="ar-box">
    <div class="ar-cup">☕</div>
    <p>Move your mouse / finger to rotate the coffee cup in 3D.</p>
  </div>
</section>

<!-- AI Fake Recommender -->
<section class="recommender">
  <h2>🤖 Recommended Cafes for You</h2>
  <div id="recommendList"></div>
  <button id="generateRecommendations">Generate Recommendations</button>
</section>

<!-- Leaderboard -->
<section class="leaderboard">
  <h2>🏅 Leaderboard</h2>
  <table>
    <thead>
      <tr><th>Rank</th><th>Name</th><th>Score</th></tr>
    </thead>
    <tbody id="leaderboardBody"></tbody>
  </table>
</section>

<!-- Membership Levels -->
<section class="membership">
  <h2>🎖 Membership Levels</h2>
  <div class="levels">
    <div class="level bronze">Bronze</div>
    <div class="level silver">Silver</div>
    <div class="level gold">Gold</div>
    <div class="level diamond">Diamond</div>
  </div>
</section>

<!-- Community Wall -->
<section class="community-wall">
  <h2>🧑‍🤝‍🧑 Community Wall</h2>
  <textarea id="wallInput" placeholder="Write your coffee thought..."></textarea>
  <button id="postWall">Post</button>
  <div id="wallPosts"></div>
</section>

<!-- Coffee Wiki -->
<section class="coffee-wiki">
  <h2>📚 Coffee Wiki</h2>
  <div class="wiki-grid">
    <div class="wiki-card">
      <h3>Espresso</h3>
      <p>Strong coffee made by forcing hot water through finely-ground beans.</p>
    </div>
    <div class="wiki-card">
      <h3>Latte</h3>
      <p>Espresso with steamed milk and a layer of foam.</p>
    </div>
    <div class="wiki-card">
      <h3>Mocha</h3>
      <p>A mix of chocolate, espresso, and milk.</p>
    </div>
    <div class="wiki-card">
      <h3>Cold Brew</h3>
      <p>Coffee brewed slowly with cold water for a smoother taste.</p>
    </div>
  </div>
</section>

<!-- Immersive Mode -->
<button id="immersiveBtn" class="immersive-btn">Enter Immersive Mode 🖥</button>

<style>
/* Animated Gradient */
#animatedGradient {
  position:fixed; top:0; left:0; width:100%; height:100%;
  z-index:-10;
  background: linear-gradient(270deg,#18dcff,#ff4d8d,#7158e2,#ffd166);
  background-size: 800% 800%;
  animation: gradientMove 30s ease infinite;
}
@keyframes gradientMove {
  0% {background-position:0% 50%}
  50% {background-position:100% 50%}
  100% {background-position:0% 50%}
}

/* AR/VR */
.ar-vr { margin:50px 0; padding:20px; text-align:center; background:var(--card-bg); border-radius:16px;}
.ar-box { perspective:1000px; }
.ar-cup {
  width:100px; height:100px; background:#8b4513; border-radius:50%;
  margin:20px auto; line-height:100px; font-size:40px; color:white;
  transform-style:preserve-3d; transition:transform 0.3s;
}

/* Recommender */
.recommender { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
#recommendList { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:15px; margin-top:15px;}
.recommend-card { padding:15px; background:var(--bg-secondary); border-radius:12px; box-shadow:var(--shadow); }

/* Leaderboard */
.leaderboard { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
.leaderboard table { width:100%; border-collapse:collapse;}
.leaderboard th, .leaderboard td { padding:10px; border:1px solid var(--border-color); text-align:center;}
.leaderboard tr:nth-child(odd){background:var(--bg-secondary);}

/* Membership */
.membership { margin:50px 0; text-align:center; }
.levels { display:flex; justify-content:center; gap:20px;}
.level { padding:20px; border-radius:12px; font-weight:bold; width:120px;}
.level.bronze { background:#cd7f32; }
.level.silver { background:#c0c0c0; }
.level.gold { background:#ffd700; }
.level.diamond { background:linear-gradient(135deg,#0ff,#7158e2); color:#fff; }

/* Community Wall */
.community-wall { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
#wallInput { width:100%; height:100px; margin-bottom:10px; padding:10px; border-radius:8px;}
.wall-post { padding:12px; margin:10px 0; background:var(--bg-secondary); border-radius:8px; }

/* Coffee Wiki */
.coffee-wiki { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
.wiki-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(200px,1fr)); gap:20px;}
.wiki-card { padding:15px; background:var(--bg-secondary); border-radius:12px; box-shadow:var(--shadow); }

/* Immersive Mode */
.immersive-btn {
  position:fixed; bottom:180px; right:30px;
  padding:12px 20px; border:none;
  border-radius:12px;
  background:linear-gradient(135deg,#0ff,#ff4d8d);
  color:white; font-weight:bold; cursor:pointer;
}
</style>

<script>
// ========== AR/VR Rotation ==========
const arCup=document.querySelector(".ar-cup");
document.addEventListener("mousemove",e=>{
  const x=(window.innerWidth/2 - e.pageX)/20;
  const y=(window.innerHeight/2 - e.pageY)/20;
  arCup.style.transform=`rotateY(${x}deg) rotateX(${y}deg)`;
});

// ========== AI Fake Recommender ==========
const cafes=["Arabica Coffee","Starbucks Riyadh","Deem Coffee","Aromatic Bean","Coffee Kai","Elite Cafe","Riche Cafe"];
document.getElementById("generateRecommendations").onclick=()=>{
  const list=document.getElementById("recommendList");
  list.innerHTML="";
  for(let i=0;i<3;i++){
    const cafe=cafes[Math.floor(Math.random()*cafes.length)];
    const div=document.createElement("div");
    div.className="recommend-card";
    div.textContent=`Recommended: ${cafe}`;
    list.appendChild(div);
  }
  showNotification("Recommendations generated!","success");
};

// ========== Leaderboard ==========
const players=[
  {name:"Ali",score:120},
  {name:"Sara",score:200},
  {name:"Mohammed",score:150},
  {name:"Fatimah",score:180}
];
function renderLeaderboard(){
  const body=document.getElementById("leaderboardBody");
  body.innerHTML="";
  players.sort((a,b)=>b.score-a.score);
  players.forEach((p,i)=>{
    const tr=document.createElement("tr");
    tr.innerHTML=`<td>${i+1}</td><td>${p.name}</td><td>${p.score}</td>`;
    body.appendChild(tr);
  });
}
renderLeaderboard();

// ========== Community Wall ==========
document.getElementById("postWall").onclick=()=>{
  const input=document.getElementById("wallInput");
  if(input.value.trim()){
    const div=document.createElement("div");
    div.className="wall-post";
    div.textContent=input.value;
    document.getElementById("wallPosts").prepend(div);
    input.value="";
  }
};

// ========== Immersive Mode ==========
document.getElementById("immersiveBtn").onclick=()=>{
  if(!document.fullscreenElement){
    document.documentElement.requestFullscreen();
    showNotification("Immersive Mode On 🖥","success");
  }else{
    document.exitFullscreen();
    showNotification("Immersive Mode Off","info");
  }
};
</script>
<!-- ====================== PART 9 END ====================== -->
        <!-- ================= EXTRA FEATURES PART 1 ================= -->
        <!-- Dynamic Galaxy Background Layer -->
        <div id="galaxy-bg"></div>

        <style>
            /* Galaxy Background */
            #galaxy-bg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -2;
                overflow: hidden;
                background: black;
            }

            .star {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                animation: twinkle 3s infinite ease-in-out;
            }

            @keyframes twinkle {
                0% { opacity: 0.2; transform: scale(0.5); }
                50% { opacity: 1; transform: scale(1); }
                100% { opacity: 0.2; transform: scale(0.5); }
            }

            .shooting-star {
                position: absolute;
                width: 2px;
                height: 100px;
                background: linear-gradient(180deg, white, transparent);
                opacity: 0.8;
                animation: shoot 2s linear forwards;
            }

            @keyframes shoot {
                0% { transform: translateY(-200px) translateX(0); opacity: 1; }
                100% { transform: translateY(800px) translateX(200px); opacity: 0; }
            }
        </style>

        <script>
            // Add random stars to galaxy
            function createStars() {
                const galaxy = document.getElementById("galaxy-bg");
                for (let i = 0; i < 120; i++) {
                    const star = document.createElement("div");
                    star.classList.add("star");
                    const size = Math.random() * 3;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;
                    star.style.top = `${Math.random() * window.innerHeight}px`;
                    star.style.left = `${Math.random() * window.innerWidth}px`;
                    star.style.animationDuration = `${2 + Math.random() * 3}s`;
                    galaxy.appendChild(star);
                }
            }

            // Shooting star
            function shootingStar() {
                const galaxy = document.getElementById("galaxy-bg");
                const star = document.createElement("div");
                star.classList.add("shooting-star");
                star.style.left = `${Math.random() * window.innerWidth}px`;
                galaxy.appendChild(star);

                setTimeout(() => {
                    galaxy.removeChild(star);
                }, 2000);
            }

            createStars();
            setInterval(shootingStar, 6000);
        </script>

        <!-- Floating Social Media Buttons -->
        <div class="floating-social">
            <a href="https://twitter.com" target="_blank" class="social-btn twitter"><i class="fab fa-twitter"></i></a>
            <a href="https://facebook.com" target="_blank" class="social-btn facebook"><i class="fab fa-facebook-f"></i></a>
            <a href="https://instagram.com" target="_blank" class="social-btn instagram"><i class="fab fa-instagram"></i></a>
            <a href="https://github.com" target="_blank" class="social-btn github"><i class="fab fa-github"></i></a>
        </div>

        <style>
            .floating-social {
                position: fixed;
                top: 40%;
                right: 20px;
                display: flex;
                flex-direction: column;
                gap: 12px;
                z-index: 10000;
            }

            .social-btn {
                width: 45px;
                height: 45px;
                display: flex;
                align-items: center;
                justify-content: center;
                border-radius: 50%;
                font-size: 18px;
                color: white;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                transition: all 0.3s;
            }

            .social-btn:hover {
                transform: scale(1.2) rotate(10deg);
                box-shadow: 0 6px 18px rgba(0,0,0,0.5);
            }

            .twitter { background: #1da1f2; }
            .facebook { background: #1877f2; }
            .instagram { background: radial-gradient(circle at 30% 30%, #f58529, #dd2a7b, #8134af, #515bd4); }
            .github { background: #333; }
        </style>

        <!-- Scroll Progress Bar -->
        <div id="scroll-progress"></div>

        <style>
            #scroll-progress {
                position: fixed;
                top: 0;
                left: 0;
                height: 5px;
                background: linear-gradient(90deg, var(--neon-blue), var(--neon-pink));
                width: 0%;
                z-index: 2000;
            }
        </style>

        <script>
            // Scroll progress
            window.addEventListener("scroll", () => {
                const scrollTop = document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (scrollTop / scrollHeight) * 100;
                document.getElementById("scroll-progress").style.width = scrolled + "%";
            });
        </script>

        <!-- Back to Top Button -->
        <button id="backToTop"><i class="fas fa-arrow-up"></i></button>

        <style>
            #backToTop {
                position: fixed;
                bottom: 80px;
                right: 30px;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                border: none;
                background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
                color: white;
                font-size: 20px;
                display: none;
                cursor: pointer;
                z-index: 2000;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                transition: all 0.3s;
            }
            #backToTop:hover {
                transform: scale(1.1);
                box-shadow: 0 6px 20px rgba(0,0,0,0.5);
            }
        </style>

        <script>
            const backToTopBtn = document.getElementById("backToTop");
            window.addEventListener("scroll", () => {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = "block";
                } else {
                    backToTopBtn.style.display = "none";
                }
            });

            backToTopBtn.addEventListener("click", () => {
                window.scrollTo({ top: 0, behavior: "smooth" });
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 1 ================= -->
        <!-- ================= EXTRA FEATURES PART 2 ================= -->
        <!-- Weather Widget -->
        <div id="weather-widget" class="weather-widget">
            <h4><i class="fas fa-cloud-sun"></i> Live Weather</h4>
            <p id="weather-location">Riyadh, Saudi Arabia</p>
            <p id="weather-temp">-- °C</p>
            <p id="weather-condition">Loading...</p>
        </div>

        <style>
            .weather-widget {
                position: fixed;
                top: 20px;
                left: 20px;
                background: var(--card-bg);
                padding: 15px 20px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                z-index: 999;
                color: var(--text-primary);
                width: 200px;
                text-align: center;
            }
            .weather-widget h4 {
                margin-bottom: 10px;
                font-weight: 700;
            }
            .weather-widget p {
                margin: 5px 0;
                font-size: 0.95rem;
            }
        </style>

        <script>
            // Free Weather using Open-Meteo API
            async function loadWeather() {
                try {
                    const lat = 24.7136;
                    const lon = 46.6753;
                    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                    const data = await res.json();
                    document.getElementById("weather-temp").textContent = data.current_weather.temperature + " °C";
                    document.getElementById("weather-condition").textContent = "Wind " + data.current_weather.windspeed + " km/h";
                } catch (e) {
                    document.getElementById("weather-condition").textContent = "Weather unavailable";
                }
            }
            loadWeather();
        </script>

        <!-- Daily Quote Widget -->
        <div id="quote-widget" class="quote-widget">
            <h4><i class="fas fa-quote-left"></i> Daily Quote</h4>
            <p id="daily-quote">Loading...</p>
        </div>

        <style>
            .quote-widget {
                position: fixed;
                bottom: 20px;
                left: 20px;
                background: var(--card-bg);
                padding: 15px 20px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                z-index: 999;
                width: 250px;
                font-size: 0.9rem;
                color: var(--text-primary);
            }
            .quote-widget h4 {
                margin-bottom: 8px;
                font-weight: 700;
            }
        </style>

        <script>
            // Free API for quotes
            async function loadQuote() {
                try {
                    const res = await fetch("https://type.fit/api/quotes");
                    const quotes = await res.json();
                    const random = quotes[Math.floor(Math.random() * quotes.length)];
                    document.getElementById("daily-quote").textContent = random.text;
                } catch {
                    document.getElementById("daily-quote").textContent = "Stay positive, drink coffee ☕";
                }
            }
            loadQuote();
        </script>

        <!-- Animated Neon Border for Header -->
        <style>
            header {
                border: 2px solid transparent;
                border-radius: 16px;
                background-clip: padding-box;
                position: relative;
            }
            header::after {
                content: '';
                position: absolute;
                top: -2px; left: -2px; right: -2px; bottom: -2px;
                background: linear-gradient(90deg, var(--neon-blue), var(--neon-pink), var(--cyber-yellow));
                border-radius: 18px;
                z-index: -1;
                animation: neonBorder 5s linear infinite;
                background-size: 300% 300%;
            }
            @keyframes neonBorder {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
        </style>

        <!-- Keyboard Shortcuts -->
        <script>
            document.addEventListener("keydown", function(e) {
                if (e.key === "t") {
                    window.scrollTo({ top: 0, behavior: "smooth" });
                    showNotification("Shortcut: Back to Top", "info");
                }
                if (e.key === "m") {
                    document.getElementById("chatbotToggle").click();
                    showNotification("Shortcut: Chatbot toggled", "info");
                }
                if (e.key === "d") {
                    document.body.setAttribute("data-theme", "dark");
                    showNotification("Switched to Dark Mode", "success");
                }
                if (e.key === "l") {
                    document.body.setAttribute("data-theme", "light");
                    showNotification("Switched to Light Mode", "success");
                }
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 2 ================= -->
        <!-- ================= EXTRA FEATURES PART 3 ================= -->
        <!-- Music Player Widget -->
        <div id="music-player" class="music-player">
            <h4><i class="fas fa-music"></i> Chill Coffee Beats</h4>
            <audio id="player" controls loop>
                <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>

        <style>
            .music-player {
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: var(--card-bg);
                padding: 15px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                z-index: 1500;
                width: 260px;
                text-align: center;
            }
            .music-player h4 {
                margin-bottom: 10px;
                font-weight: 700;
            }
            .music-player audio {
                width: 100%;
                outline: none;
            }
        </style>

        <!-- Notification Bell -->
        <div id="notif-bell" class="notif-bell">
            <i class="fas fa-bell"></i>
            <span id="notif-count">0</span>
        </div>

        <style>
            .notif-bell {
                position: fixed;
                top: 100px;
                right: 30px;
                background: linear-gradient(135deg, var(--neon-pink), var(--space-purple));
                color: white;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 20px;
                cursor: pointer;
                z-index: 1200;
                box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            }
            .notif-bell span {
                position: absolute;
                top: 5px;
                right: 5px;
                background: red;
                color: white;
                font-size: 12px;
                padding: 2px 6px;
                border-radius: 12px;
            }
        </style>

        <script>
            let notifCount = 0;
            const notifBell = document.getElementById("notif-bell");
            notifBell.addEventListener("click", () => {
                notifCount = 0;
                document.getElementById("notif-count").textContent = notifCount;
                showNotification("No new notifications", "info");
            });

            // simulate random notifications
            setInterval(() => {
                notifCount++;
                document.getElementById("notif-count").textContent = notifCount;
                showNotification("New coffee offer nearby! ☕", "success");
            }, 20000);
        </script>

        <!-- Easter Egg (Konami Code) -->
        <script>
            let konami = [];
            const secret = "38384040373937396665"; // up up down down left right left right b a
            document.addEventListener("keydown", (e) => {
                konami.push(e.keyCode);
                if (konami.join("").includes(secret)) {
                    showNotification("🎉 Secret Unlocked: Cosmic Coffee Mode!", "success");
                    document.body.style.background = "linear-gradient(45deg, #ff4d8d, #18dcff, #ffd166)";
                }
            });
        </script>

        <!-- Floating Clock -->
        <div id="floating-clock"></div>

        <style>
            #floating-clock {
                position: fixed;
                top: 20px;
                right: 50%;
                transform: translateX(50%);
                background: rgba(0,0,0,0.6);
                color: white;
                padding: 8px 15px;
                border-radius: 20px;
                font-weight: 600;
                font-size: 0.95rem;
                z-index: 1500;
                box-shadow: 0 2px 10px rgba(0,0,0,0.3);
            }
        </style>

        <script>
            function updateClock() {
                const now = new Date();
                document.getElementById("floating-clock").textContent =
                    now.toLocaleTimeString();
            }
            setInterval(updateClock, 1000);
            updateClock();
        </script>

        <!-- User Visit Counter -->
        <div id="visit-counter" class="visit-counter">
            <i class="fas fa-user"></i> Visits: <span id="visit-count">0</span>
        </div>

        <style>
            .visit-counter {
                position: fixed;
                bottom: 90px;
                left: 20px;
                background: var(--card-bg);
                padding: 8px 12px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                font-size: 0.9rem;
                color: var(--text-primary);
                z-index: 900;
            }
        </style>

        <script>
            let visits = localStorage.getItem("visits") || 0;
            visits++;
            localStorage.setItem("visits", visits);
            document.getElementById("visit-count").textContent = visits;
        </script>

        <!-- ================= END EXTRA FEATURES PART 3 ================= -->
        <!-- ================= EXTRA FEATURES PART 4 ================= -->
        <!-- Reading Mode -->
        <button id="readingModeBtn" class="reading-mode-btn">
            <i class="fas fa-book-reader"></i>
        </button>

        <style>
            .reading-mode-btn {
                position: fixed;
                bottom: 160px;
                right: 30px;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                background: linear-gradient(135deg, #00ff8c, #00b36b);
                color: white;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 20px;
                z-index: 1400;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            }
            body.reading-mode {
                background: #fefae0 !important;
                color: #222 !important;
                line-height: 1.9;
                font-size: 1.15rem;
            }
        </style>

        <script>
            document.getElementById("readingModeBtn").addEventListener("click", () => {
                document.body.classList.toggle("reading-mode");
                showNotification("Reading Mode toggled", "info");
            });
        </script>

        <!-- Wave Animation Background -->
        <canvas id="waveCanvas"></canvas>

        <style>
            #waveCanvas {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 200px;
                z-index: -1;
            }
        </style>

        <script>
            const waveCanvas = document.getElementById("waveCanvas");
            const waveCtx = waveCanvas.getContext("2d");
            waveCanvas.width = window.innerWidth;
            waveCanvas.height = 200;

            function drawWaves() {
                waveCtx.clearRect(0, 0, waveCanvas.width, waveCanvas.height);
                waveCtx.fillStyle = "rgba(113,88,226,0.3)";
                waveCtx.beginPath();
                for (let x = 0; x < waveCanvas.width; x++) {
                    const y = 100 + Math.sin(x * 0.02 + Date.now() * 0.002) * 20;
                    waveCtx.lineTo(x, y);
                }
                waveCtx.lineTo(waveCanvas.width, waveCanvas.height);
                waveCtx.lineTo(0, waveCanvas.height);
                waveCtx.closePath();
                waveCtx.fill();
            }
            setInterval(drawWaves, 30);
        </script>

        <!-- Control Panel -->
        <div id="control-panel" class="control-panel">
            <h4><i class="fas fa-cogs"></i> Control Panel</h4>
            <button onclick="document.body.setAttribute('data-theme','light')">Light</button>
            <button onclick="document.body.setAttribute('data-theme','dark')">Dark</button>
            <button onclick="document.body.setAttribute('data-theme','space')">Space</button>
            <button onclick="toggleSteam()">☕ Toggle Steam</button>
        </div>

        <style>
            .control-panel {
                position: fixed;
                top: 200px;
                left: -220px;
                width: 200px;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                padding: 15px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                transition: left 0.4s;
                z-index: 1600;
            }
            .control-panel:hover {
                left: 20px;
            }
            .control-panel h4 {
                font-size: 1rem;
                margin-bottom: 10px;
            }
            .control-panel button {
                display: block;
                margin: 8px 0;
                padding: 6px 12px;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                width: 100%;
                font-size: 0.9rem;
                background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
                color: white;
            }
        </style>

        <script>
            function toggleSteam() {
                const steam = document.querySelectorAll(".steam");
                steam.forEach(s => {
                    if (s.style.display === "none") {
                        s.style.display = "block";
                    } else {
                        s.style.display = "none";
                    }
                });
                showNotification("Steam toggled", "info");
            }
        </script>

        <!-- Keyboard Sound Effect -->
        <audio id="key-sound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

        <script>
            document.addEventListener("keypress", () => {
                const sound = document.getElementById("key-sound");
                sound.currentTime = 0;
                sound.play();
            });
        </script>

        <!-- Glow Cursor -->
        <div id="cursor-glow"></div>

        <style>
            #cursor-glow {
                position: fixed;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(24,220,255,0.6), transparent 70%);
                pointer-events: none;
                mix-blend-mode: screen;
                z-index: 2000;
                transform: translate(-50%, -50%);
            }
        </style>

        <script>
            const glow = document.getElementById("cursor-glow");
            document.addEventListener("mousemove", (e) => {
                glow.style.top = e.clientY + "px";
                glow.style.left = e.clientX + "px";
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 4 ================= -->
        <!-- ================= EXTRA FEATURES PART 5 ================= -->
        <!-- Rain Effect -->
        <canvas id="rainCanvas"></canvas>

        <style>
            #rainCanvas {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -3;
                pointer-events: none;
            }
        </style>

        <script>
            const rainCanvas = document.getElementById("rainCanvas");
            const rainCtx = rainCanvas.getContext("2d");
            rainCanvas.width = window.innerWidth;
            rainCanvas.height = window.innerHeight;

            const drops = [];
            for (let i = 0; i < 150; i++) {
                drops.push({
                    x: Math.random() * rainCanvas.width,
                    y: Math.random() * rainCanvas.height,
                    length: Math.random() * 20 + 10,
                    speed: Math.random() * 4 + 2
                });
            }

            function drawRain() {
                rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);
                rainCtx.strokeStyle = "rgba(24,220,255,0.5)";
                rainCtx.lineWidth = 1;
                for (let d of drops) {
                    rainCtx.beginPath();
                    rainCtx.moveTo(d.x, d.y);
                    rainCtx.lineTo(d.x, d.y + d.length);
                    rainCtx.stroke();
                    d.y += d.speed;
                    if (d.y > rainCanvas.height) d.y = -20;
                }
            }
            setInterval(drawRain, 30);
        </script>

        <!-- Matrix Effect -->
        <canvas id="matrixCanvas"></canvas>

        <style>
            #matrixCanvas {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -4;
                pointer-events: none;
                opacity: 0.3;
            }
        </style>

        <script>
            const matrixCanvas = document.getElementById("matrixCanvas");
            const matrixCtx = matrixCanvas.getContext("2d");
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;

            const letters = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            const fontSize = 14;
            const columns = matrixCanvas.width / fontSize;
            const dropsM = [];
            for (let i = 0; i < columns; i++) dropsM[i] = 1;

            function drawMatrix() {
                matrixCtx.fillStyle = "rgba(0, 0, 0, 0.05)";
                matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                matrixCtx.fillStyle = "#0f0";
                matrixCtx.font = fontSize + "px monospace";
                for (let i = 0; i < dropsM.length; i++) {
                    const text = letters[Math.floor(Math.random() * letters.length)];
                    matrixCtx.fillText(text, i * fontSize, dropsM[i] * fontSize);
                    if (dropsM[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
                        dropsM[i] = 0;
                    }
                    dropsM[i]++;
                }
            }
            setInterval(drawMatrix, 50);
        </script>

        <!-- Typing Counter -->
        <div id="typing-counter" class="typing-counter">
            Keys typed: <span id="keys-count">0</span>
        </div>

        <style>
            .typing-counter {
                position: fixed;
                bottom: 20px;
                right: 300px;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 12px;
                padding: 8px 15px;
                box-shadow: var(--shadow);
                font-size: 0.9rem;
                color: var(--text-primary);
                z-index: 1100;
            }
        </style>

        <script>
            let keyCount = 0;
            document.addEventListener("keydown", () => {
                keyCount++;
                document.getElementById("keys-count").textContent = keyCount;
            });
        </script>

        <!-- Zen Mode -->
        <button id="zenBtn" class="zen-btn"><i class="fas fa-yin-yang"></i></button>

        <style>
            .zen-btn {
                position: fixed;
                bottom: 230px;
                right: 30px;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                background: linear-gradient(135deg, #18dcff, #7158e2);
                color: white;
                border: none;
                font-size: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 1300;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            }
            body.zen-mode {
                background: radial-gradient(circle, #222 0%, #000 100%) !important;
                color: #eee !important;
                font-size: 1.2rem;
                line-height: 2;
            }
        </style>

        <script>
            document.getElementById("zenBtn").addEventListener("click", () => {
                document.body.classList.toggle("zen-mode");
                showNotification("Zen Mode toggled 🧘", "info");
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 5 ================= -->
        <!-- ================= EXTRA FEATURES PART 6 ================= -->
        <!-- Neon Background Animation -->
        <div id="neon-bg"></div>

        <style>
            #neon-bg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -5;
                background: linear-gradient(270deg, #18dcff, #ff4d8d, #ffd166, #7158e2);
                background-size: 800% 800%;
                animation: neonBG 20s ease infinite;
                opacity: 0.2;
            }
            @keyframes neonBG {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
        </style>

        <!-- Session Timer -->
        <div id="session-timer" class="session-timer">
            Session Time: <span id="session-time">0</span> mins
        </div>

        <style>
            .session-timer {
                position: fixed;
                top: 60px;
                right: 20px;
                background: var(--card-bg);
                padding: 8px 15px;
                border-radius: 12px;
                border: 1px solid var(--border-color);
                font-size: 0.9rem;
                font-weight: 600;
                box-shadow: var(--shadow);
                color: var(--text-primary);
                z-index: 1200;
            }
        </style>

        <script>
            let minutes = 0;
            setInterval(() => {
                minutes++;
                document.getElementById("session-time").textContent = minutes;
            }, 60000);
        </script>

        <!-- Daily Coffee Counter -->
        <div id="coffee-counter" class="coffee-counter">
            ☕ Coffees Today: <span id="coffee-count">0</span>
            <button onclick="addCoffee()">+1</button>
        </div>

        <style>
            .coffee-counter {
                position: fixed;
                bottom: 300px;
                left: 20px;
                background: var(--card-bg);
                padding: 10px 15px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                font-size: 0.95rem;
                color: var(--text-primary);
                z-index: 1100;
            }
            .coffee-counter button {
                margin-left: 10px;
                border: none;
                border-radius: 8px;
                padding: 4px 10px;
                background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
                color: white;
                cursor: pointer;
            }
        </style>

        <script>
            let todayCoffee = localStorage.getItem("coffeeCount") || 0;
            document.getElementById("coffee-count").textContent = todayCoffee;
            function addCoffee() {
                todayCoffee++;
                localStorage.setItem("coffeeCount", todayCoffee);
                document.getElementById("coffee-count").textContent = todayCoffee;
                showNotification("Coffee added! ☕ Total: " + todayCoffee, "success");
            }
        </script>

        <!-- Party Mode -->
        <button id="partyBtn" class="party-btn"><i class="fas fa-bolt"></i></button>

        <style>
            .party-btn {
                position: fixed;
                bottom: 370px;
                right: 30px;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                border: none;
                background: linear-gradient(135deg, #ff6b6b, #ffd166);
                color: white;
                font-size: 20px;
                cursor: pointer;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 1300;
            }
        </style>

        <script>
            document.getElementById("partyBtn").addEventListener("click", () => {
                for (let i = 0; i < 30; i++) {
                    const confetti = document.createElement("div");
                    confetti.style.position = "fixed";
                    confetti.style.top = Math.random() * window.innerHeight + "px";
                    confetti.style.left = Math.random() * window.innerWidth + "px";
                    confetti.style.width = "8px";
                    confetti.style.height = "8px";
                    confetti.style.background = ["#ff4d8d","#18dcff","#ffd166","#00ff8c"][Math.floor(Math.random()*4)];
                    confetti.style.opacity = 0.8;
                    confetti.style.borderRadius = "50%";
                    confetti.style.zIndex = 2000;
                    confetti.style.animation = "fall 3s linear forwards";
                    document.body.appendChild(confetti);
                    setTimeout(()=>confetti.remove(), 3000);
                }
                showNotification("Party Mode Activated 🎉", "success");
            });

            const style = document.createElement("style");
            style.textContent = `
                @keyframes fall {
                    to { transform: translateY(500px) rotate(360deg); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        </script>

        <!-- ================= END EXTRA FEATURES PART 6 ================= -->
        <!-- ================= NEW FEATURE: ADVANCED AI CHATBOT ================= -->
        <script>
            const chatbotInput = document.getElementById("chatbotInput");
            const chatbotMessages = document.getElementById("chatbotMessages");
            const sendMessageBtn = document.getElementById("sendMessage");

            function addMessage(text, sender = "bot") {
                const msg = document.createElement("div");
                msg.className = "message " + sender;
                chatbotMessages.appendChild(msg);

                // Typewriter effect for bot
                if (sender === "bot") {
                    let i = 0;
                    function typing() {
                        if (i < text.length) {
                            msg.textContent += text.charAt(i);
                            i++;
                            setTimeout(typing, 40);
                        }
                    }
                    typing();
                } else {
                    msg.textContent = text;
                }

                chatbotMessages.scrollTop = chatbotMessages.scrollHeight;
            }

            function getBotResponse(userMsg) {
                const msg = userMsg.toLowerCase();
                if (msg.includes("help")) {
                    return "🤖 Available commands:\n- 'coffee' → Random coffee fact\n- 'joke' → Coffee joke\n- 'quote' → Daily quote\n- 'location' → Riyadh, Saudi Arabia\n- 'time' → Current time";
                }
                if (msg.includes("coffee")) {
                    const facts = [
                        "☕ Did you know? Coffee is the second most traded commodity after oil.",
                        "☕ The word 'coffee' comes from the Arabic word 'qahwa'.",
                        "☕ Coffee can improve your energy levels and brain function."
                    ];
                    return facts[Math.floor(Math.random() * facts.length)];
                }
                if (msg.includes("joke")) {
                    return "😂 Why don't coffee beans ever gossip? Because they don’t want to espresso too much!";
                }
                if (msg.includes("quote")) {
                    return "✨ 'Life happens, coffee helps.' – Anonymous";
                }
                if (msg.includes("location")) {
                    return "📍 Riyadh, Saudi Arabia 🌍";
                }
                if (msg.includes("time")) {
                    return "⏰ Current time: " + new Date().toLocaleTimeString();
                }
                return "🤖 Interesting! Tell me more...";
            }

            sendMessageBtn.addEventListener("click", () => {
                const text = chatbotInput.value.trim();
                if (!text) return;
                addMessage(text, "user");
                chatbotInput.value = "";

                setTimeout(() => {
                    const reply = getBotResponse(text);
                    addMessage(reply, "bot");
                }, 600);
            });

            chatbotInput.addEventListener("keypress", (e) => {
                if (e.key === "Enter") sendMessageBtn.click();
            });
        </script>
        <!-- ================= END ADVANCED AI CHATBOT ================= -->
        <!-- ================= NEW FEATURE: 3D COFFEE CUP ================= -->
        <section id="coffee-3d" style="margin:60px 0; text-align:center;">
            <h2 style="color:var(--text-primary); margin-bottom:20px;">☕ 3D Coffee Cup</h2>
            <div id="three-container" style="width:100%; height:500px;"></div>
        </section>

        <!-- Three.js Library -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

        <script>
            const container = document.getElementById("three-container");
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth/container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);

            // Lighting
            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(10, 10, 10);
            scene.add(light);

            // Cup (Cylinder + Torus as handle)
            const material = new THREE.MeshPhongMaterial({ color: 0x8B4513, shininess: 100 });
            const cup = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 4, 32, 1, false), material);
            scene.add(cup);

            // Handle
            const handle = new THREE.Mesh(new THREE.TorusGeometry(1.2, 0.3, 16, 100, Math.PI), material);
            handle.position.set(2.5, 0, 0);
            handle.rotation.z = Math.PI / 2;
            scene.add(handle);

            // Coffee surface
            const coffeeMat = new THREE.MeshPhongMaterial({ color: 0x3e2723 });
            const coffeeSurface = new THREE.Mesh(new THREE.CircleGeometry(2, 32), coffeeMat);
            coffeeSurface.rotation.x = -Math.PI / 2;
            coffeeSurface.position.y = 2;
            scene.add(coffeeSurface);

            // Floor
            const floor = new THREE.Mesh(new THREE.PlaneGeometry(20,20), new THREE.MeshPhongMaterial({color:0x444}));
            floor.rotation.x = -Math.PI/2;
            floor.position.y = -2;
            scene.add(floor);

            camera.position.z = 8;
            camera.position.y = 3;

            // Controls
            const controls = new THREE.OrbitControls(camera, renderer.domElement);

            // Animate
            function animate() {
                requestAnimationFrame(animate);
                cup.rotation.y += 0.003;
                handle.rotation.y += 0.003;
                coffeeSurface.rotation.z += 0.001;
                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener("resize", () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        </script>
        <!-- ================= END 3D COFFEE CUP ================= -->
        <!-- ================= NEW FEATURE: FLAPPY COFFEE GAME ================= -->
        <section id="flappy-coffee" style="margin:60px 0; text-align:center;">
            <h2 style="color:var(--text-primary); margin-bottom:20px;">🕹 Flappy Coffee Game</h2>
            <canvas id="flappyCanvas" width="480" height="400" style="border:2px solid var(--border-color); border-radius:12px; background:#c4a484;"></canvas>
            <p style="margin-top:10px; color:var(--text-secondary);">Press <b>SPACE</b> to jump ☕</p>
        </section>

        <script>
            const canvasF = document.getElementById("flappyCanvas");
            const ctxF = canvasF.getContext("2d");

            let coffeeY = 200;
            let gravity = 1.5;
            let velocity = 0;
            let pipes = [];
            let score = 0;

            const coffeeImg = new Image();
            coffeeImg.src = "https://img.icons8.com/emoji/48/coffee.png";

            document.addEventListener("keydown", e => {
                if (e.code === "Space") {
                    velocity = -20;
                }
            });

            function drawCoffee() {
                ctxF.drawImage(coffeeImg, 50, coffeeY, 40, 40);
            }

            function drawPipes() {
                for (let i = 0; i < pipes.length; i++) {
                    let p = pipes[i];
                    ctxF.fillStyle = "#5d4037";
                    ctxF.fillRect(p.x, 0, 40, p.top);
                    ctxF.fillRect(p.x, p.top + p.gap, 40, canvasF.height - p.top - p.gap);

                    p.x -= 3;
                    if (p.x + 40 < 0) {
                        pipes.splice(i, 1);
                        i--;
                        score++;
                    }

                    if (
                        50 < p.x + 40 &&
                        50 + 40 > p.x &&
                        (coffeeY < p.top || coffeeY + 40 > p.top + p.gap)
                    ) {
                        gameOver();
                    }
                }
            }

            function drawScore() {
                ctxF.fillStyle = "white";
                ctxF.font = "20px Arial";
                ctxF.fillText("Score: " + score, 10, 30);
            }

            function updateGame() {
                ctxF.clearRect(0, 0, canvasF.width, canvasF.height);
                drawCoffee();
                drawPipes();
                drawScore();

                velocity += gravity * 0.5;
                coffeeY += velocity * 0.5;

                if (coffeeY + 40 > canvasF.height) {
                    gameOver();
                }

                requestAnimationFrame(updateGame);
            }

            function spawnPipe() {
                const top = Math.random() * 200 + 50;
                const gap = 120;
                pipes.push({ x: canvasF.width, top: top, gap: gap });
            }

            function gameOver() {
                showNotification("Game Over! Final Score: " + score, "error");
                score = 0;
                coffeeY = 200;
                pipes = [];
                velocity = 0;
            }

            setInterval(spawnPipe, 2000);
            updateGame();
        </script>
        <!-- ================= END FLAPPY COFFEE GAME ================= -->
        <!-- ================= NEW FEATURE: VISITOR CHAT ROOM ================= -->
        <section id="visitor-chat" style="margin:60px 0; text-align:center;">
            <h2 style="color:var(--text-primary); margin-bottom:15px;">💬 Visitor Chat Room</h2>
            <div id="chat-room" style="width:90%;max-width:500px;height:350px;border:2px solid var(--border-color);border-radius:12px;overflow-y:auto;margin:auto;background:var(--card-bg);padding:10px;text-align:left;"></div>
            <input id="chat-nick" type="text" placeholder="Enter nickname..." style="margin-top:10px;width:45%;padding:8px;border-radius:8px;border:1px solid var(--border-color);">
            <input id="chat-msg" type="text" placeholder="Type message..." style="margin-top:10px;width:45%;padding:8px;border-radius:8px;border:1px solid var(--border-color);">
            <button id="chat-send" style="padding:8px 15px;margin-top:10px;border:none;border-radius:8px;background:linear-gradient(135deg,var(--neon-blue),var(--space-purple));color:white;cursor:pointer;">Send</button>
        </section>

        <script>
            const chatRoom = document.getElementById("chat-room");
            const chatNick = document.getElementById("chat-nick");
            const chatMsg = document.getElementById("chat-msg");
            const chatSend = document.getElementById("chat-send");

            let chatHistory = JSON.parse(localStorage.getItem("visitorChat")) || [];

            function renderChat() {
                chatRoom.innerHTML = "";
                chatHistory.forEach(c => {
                    const div = document.createElement("div");
                    div.style.margin = "5px 0";
                    div.innerHTML = `<b style="color:var(--neon-blue)">${c.nick}</b>: ${c.msg}`;
                    chatRoom.appendChild(div);
                });
                chatRoom.scrollTop = chatRoom.scrollHeight;
            }
            renderChat();

            chatSend.addEventListener("click", () => {
                if (!chatNick.value || !chatMsg.value) return;
                chatHistory.push({ nick: chatNick.value, msg: chatMsg.value });
                localStorage.setItem("visitorChat", JSON.stringify(chatHistory));
                chatMsg.value = "";
                renderChat();
            });

            chatMsg.addEventListener("keypress", e => {
                if (e.key === "Enter") chatSend.click();
            });
        </script>
        <!-- ================= END VISITOR CHAT ROOM ================= -->
        <!-- =============== NEW FEATURE: FUTURISTIC DASHBOARD =============== -->
        <section id="dashboard" style="margin:80px 0;">
            <h2 style="text-align:center;color:var(--text-primary);margin-bottom:25px;">📊 Coffee Finder Dashboard</h2>
            <div style="display:flex;flex-wrap:wrap;gap:30px;justify-content:center;">
                <canvas id="chart1" width="350" height="250" style="background:var(--card-bg);border-radius:12px;padding:15px;box-shadow:var(--shadow);"></canvas>
                <canvas id="chart2" width="350" height="250" style="background:var(--card-bg);border-radius:12px;padding:15px;box-shadow:var(--shadow);"></canvas>
                <canvas id="chart3" width="350" height="250" style="background:var(--card-bg);border-radius:12px;padding:15px;box-shadow:var(--shadow);"></canvas>
            </div>
        </section>

        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            // Chart 1: Ratings distribution
            const ctx1 = document.getElementById("chart1");
            new Chart(ctx1, {
                type: "bar",
                data: {
                    labels: ["⭐ 5", "⭐ 4", "⭐ 3", "⭐ 2", "⭐ 1"],
                    datasets: [{
                        label: "Number of Cafes",
                        data: [12, 19, 7, 3, 1],
                        backgroundColor: ["#00ff8c","#18dcff","#7158e2","#ffd166","#ff6b6b"]
                    }]
                },
                options: { plugins: { legend: { display: false } }, responsive:true }
            });

            // Chart 2: Features availability
            const ctx2 = document.getElementById("chart2");
            new Chart(ctx2, {
                type: "doughnut",
                data: {
                    labels: ["Wi-Fi", "Outdoor", "Parking", "Snacks"],
                    datasets: [{
                        label: "Features",
                        data: [15, 9, 6, 11],
                        backgroundColor: ["#18dcff","#ffd166","#00ff8c","#ff4d8d"]
                    }]
                },
                options: { plugins: { legend: { position:"bottom", labels:{color:"var(--text-primary)"}} } }
            });

            // Chart 3: Cities coverage
            const ctx3 = document.getElementById("chart3");
            new Chart(ctx3, {
                type: "line",
                data: {
                    labels: ["Riyadh","Jeddah","Dammam","Mecca","Medina","Abha"],
                    datasets: [{
                        label: "Cafes Found",
                        data: [25, 18, 10, 14, 9, 7],
                        borderColor: "#ff4d8d",
                        backgroundColor: "rgba(255,77,141,0.3)",
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: { scales:{ x:{ticks:{color:"var(--text-primary)"}}, y:{ticks:{color:"var(--text-primary)"}} } }
            });
        </script>
        <!-- =============== END FUTURISTIC DASHBOARD =============== -->
        <!-- =============== NEW FEATURE: ADVERTISEMENT SYSTEM =============== -->
        <section id="ads-section" style="margin:80px 0;text-align:center;">
            <h2 style="color:var(--text-primary);margin-bottom:20px;">📢 Featured Coffee Ads</h2>
            <div style="display:flex;flex-wrap:wrap;gap:25px;justify-content:center;">
                <div style="background:var(--card-bg);border-radius:16px;padding:20px;box-shadow:var(--shadow);width:300px;">
                    <h4 style="color:var(--neon-blue);margin-bottom:10px;">☕ Premium Cafe</h4>
                    <p style="color:var(--text-secondary);">Ad space for cafes who want to reach more customers!</p>
                    <button onclick="openContact()" style="margin-top:10px;padding:10px 20px;border:none;border-radius:10px;background:linear-gradient(135deg,var(--neon-blue),var(--space-purple));color:white;cursor:pointer;">Advertise Here</button>
                </div>
                <div style="background:var(--card-bg);border-radius:16px;padding:20px;box-shadow:var(--shadow);width:300px;">
                    <h4 style="color:var(--neon-pink);margin-bottom:10px;">🌟 Special Offer</h4>
                    <p style="color:var(--text-secondary);">Highlight your cafe with eye-catching banners.</p>
                    <button onclick="openContact()" style="margin-top:10px;padding:10px 20px;border:none;border-radius:10px;background:linear-gradient(135deg,var(--neon-pink),var(--space-purple));color:white;cursor:pointer;">Advertise Now</button>
                </div>
            </div>
        </section>

        <!-- Contact Page Modal -->
        <div id="contact-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;justify-content:center;align-items:center;">
            <div style="background:var(--card-bg);border-radius:16px;padding:30px;width:90%;max-width:500px;box-shadow:var(--shadow);position:relative;">
                <h3 style="color:var(--text-primary);margin-bottom:20px;">📩 Contact for Advertisement</h3>
                <p style="margin-bottom:10px;"><b>WhatsApp:</b> <a href="https://wa.me/966500000000" target="_blank" style="color:var(--neon-green)">+966 50 000 0000</a></p>
                <p style="margin-bottom:20px;"><b>Email:</b> <a href="mailto:ads@coffeefinder.sa" style="color:var(--neon-blue)">ads@coffeefinder.sa</a></p>
                
                <form onsubmit="sendAdRequest(event)">
                    <input type="text" id="ad-name" placeholder="Your Name" required style="width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid var(--border-color);">
                    <textarea id="ad-message" placeholder="Your Message..." required style="width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid var(--border-color);height:100px;"></textarea>
                    <button type="submit" style="padding:10px 20px;border:none;border-radius:10px;background:linear-gradient(135deg,var(--neon-blue),var(--space-purple));color:white;cursor:pointer;">Send</button>
                </form>

                <button onclick="closeContact()" style="position:absolute;top:15px;right:15px;border:none;background:none;color:var(--text-secondary);font-size:20px;cursor:pointer;">✖</button>
            </div>
        </div>

        <script>
            function openContact(){
                document.getElementById("contact-modal").style.display="flex";
            }
            function closeContact(){
                document.getElementById("contact-modal").style.display="none";
            }
            function sendAdRequest(e){
                e.preventDefault();
                const name=document.getElementById("ad-name").value;
                const msg=document.getElementById("ad-message").value;
                alert(`Thanks ${name}, your request has been sent!\nMessage: ${msg}`);
                closeContact();
            }
        </script>
        <!-- =============== END ADVERTISEMENT SYSTEM =============== -->
        <!-- =============== NEW FEATURE: APP DOWNLOAD + FOOTER =============== -->
        <footer style="margin-top:80px;background:var(--header-bg);padding:40px 20px;text-align:center;border-radius:16px;box-shadow:var(--shadow);">
            <h3 style="color:white;margin-bottom:20px;">📲 Get the Coffee Finder Pro App</h3>
            <div style="display:flex;gap:20px;justify-content:center;flex-wrap:wrap;margin-bottom:30px;">
                <a href="#" style="display:flex;align-items:center;gap:10px;padding:12px 20px;background:black;color:white;border-radius:10px;text-decoration:none;box-shadow:0 4px 15px rgba(0,0,0,0.3);">
                    <i class="fab fa-apple fa-2x"></i>
                    <div style="text-align:left;">
                        <small>Download on the</small><br>
                        <strong>App Store</strong>
                    </div>
                </a>
                <a href="#" style="display:flex;align-items:center;gap:10px;padding:12px 20px;background:#2ecc71;color:white;border-radius:10px;text-decoration:none;box-shadow:0 4px 15px rgba(0,0,0,0.3);">
                    <i class="fab fa-google-play fa-2x"></i>
                    <div style="text-align:left;">
                        <small>Get it on</small><br>
                        <strong>Google Play</strong>
                    </div>
                </a>
            </div>

            <p style="color:white;margin-bottom:10px;">© 2025 Coffee Finder Pro — All Rights Reserved</p>
            <p style="color:white;margin-bottom:20px;">☕ Made with ❤️ in Saudi Arabia</p>
            
            <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;">
                <a href="#privacy" style="color:var(--neon-blue);text-decoration:none;">Privacy Policy</a>
                <a href="#terms" style="color:var(--neon-green);text-decoration:none;">Terms of Service</a>
                <a href="#contact" style="color:var(--neon-pink);text-decoration:none;">Contact Us</a>
            </div>
        </footer>
        <!-- =============== END FOOTER =============== -->
        <!-- =============== NEW FEATURE: ADMIN DASHBOARD =============== -->
        <section id="dashboard" style="margin:80px 0;">
            <h2 style="text-align:center;color:var(--text-primary);margin-bottom:30px;">📊 Coffee Finder Dashboard</h2>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:30px;justify-items:center;">
                
                <!-- Visitors Chart -->
                <div style="background:var(--card-bg);padding:20px;border-radius:16px;box-shadow:var(--shadow);width:100%;max-width:500px;">
                    <h4 style="color:var(--neon-blue);margin-bottom:10px;">Visitors Growth</h4>
                    <canvas id="visitorsChart" height="200"></canvas>
                </div>

                <!-- Ratings Chart -->
                <div style="background:var(--card-bg);padding:20px;border-radius:16px;box-shadow:var(--shadow);width:100%;max-width:500px;">
                    <h4 style="color:var(--neon-pink);margin-bottom:10px;">Average Ratings</h4>
                    <canvas id="ratingsChart" height="200"></canvas>
                </div>

                <!-- Ads Chart -->
                <div style="background:var(--card-bg);padding:20px;border-radius:16px;box-shadow:var(--shadow);width:100%;max-width:500px;">
                    <h4 style="color:var(--neon-green);margin-bottom:10px;">Ads Requests</h4>
                    <canvas id="adsChart" height="200"></canvas>
                </div>
            </div>
        </section>

        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            // Visitors Chart
            const ctx1 = document.getElementById('visitorsChart').getContext('2d');
            new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul'],
                    datasets: [{
                        label: 'Visitors',
                        data: [500,800,1200,900,1500,2000,2500],
                        borderColor: '#18dcff',
                        backgroundColor: 'rgba(24,220,255,0.2)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}, scales:{x:{ticks:{color:'white'}},y:{ticks:{color:'white'}}}}
            });

            // Ratings Chart
            const ctx2 = document.getElementById('ratingsChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Arabica','Starbucks','Deem','Kai','Riche'],
                    datasets: [{
                        label: 'Avg Rating',
                        data: [4.5,4.7,4.3,4.6,4.8],
                        backgroundColor: ['#ff4d8d','#18dcff','#ffd166','#00ff8c','#7158e2']
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}, scales:{x:{ticks:{color:'white'}},y:{ticks:{color:'white'}}}}
            });

            // Ads Chart
            const ctx3 = document.getElementById('adsChart').getContext('2d');
            new Chart(ctx3, {
                type: 'doughnut',
                data: {
                    labels: ['Pending','Approved','Rejected'],
                    datasets: [{
                        label: 'Ads Requests',
                        data: [5,12,3],
                        backgroundColor: ['#ffd166','#00ff8c','#ff6b6b']
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}}
            });
        </script>
        <!-- =============== END DASHBOARD =============== -->
