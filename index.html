<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‚òï Coffee Finder Pro ‚Äî Sci-Fi Edition</title>

  <!-- ŸÖŸÉÿ™ÿ®ÿßÿ™ ÿÆÿßÿ±ÿ¨Ÿäÿ© -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" />
  <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet" />

  <style>
    /* =============================
       üåå ÿßŸÑÿ£ÿ≥ÿßÿ≥Ÿäÿßÿ™ + ÿßŸÑŸÖÿ™ÿ∫Ÿäÿ±ÿßÿ™
    ============================== */
    :root {
      --primary: #734f35;
      --secondary: #8b4513;
      --accent: #c4a484;
      --light: #f5f5f5;
      --dark: #0a1929;
      --success: #00ff8c;
      --warning: #ffd166;
      --danger: #ff6b6b;
      --gray: #6c757d;
      --coffee-light: #d7ccc8;
      --coffee-dark: #5d4037;
      --space-blue: #0a1929;
      --space-purple: #7158e2;
      --neon-blue: #18dcff;
      --neon-pink: #ff4d8d;
      --neon-green: #00ff8c;
      --cyber-yellow: #ffd166;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #0a0e17;
      color: #e9ecef;
      line-height: 1.6;
      overflow-x: hidden;
      transition: all 0.3s ease;
      background-image:
        radial-gradient(circle at 15% 50%, rgba(24,220,255,0.05) 0%, transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(113,88,226,0.05) 0%, transparent 25%),
        radial-gradient(circle at 50% 80%, rgba(255,77,141,0.05) 0%, transparent 25%);
    }

    /* ÿÆŸÑŸÅŸäÿ© ŸÅÿ∂ÿßÿ¶Ÿäÿ© */
    body.space-theme {
      background-image: url("https://www.transparenttextures.com/patterns/stardust.png"),
        radial-gradient(circle at 15% 50%, rgba(24,220,255,0.1) 0%, transparent 25%),
        radial-gradient(circle at 85% 30%, rgba(113,88,226,0.1) 0%, transparent 25%),
        radial-gradient(circle at 50% 80%, rgba(255,77,141,0.1) 0%, transparent 25%);
    }

    /* =============================
       üõ∞Ô∏è ÿßŸÑÿ´ŸäŸÖÿßÿ™
    ============================== */
    [data-theme="light"] {
      --bg-primary: #f8f9fa;
      --bg-secondary: #ffffff;
      --text-primary: #212529;
      --text-secondary: #495057;
      --card-bg: #ffffff;
      --border-color: #dee2e6;
      --header-bg: linear-gradient(135deg, var(--primary), var(--secondary));
    }

    [data-theme="dark"] {
      --bg-primary: #0a1929;
      --bg-secondary: #0f253d;
      --text-primary: #e9ecef;
      --text-secondary: #adb5bd;
      --card-bg: #132238;
      --border-color: #2a3e5a;
      --header-bg: linear-gradient(135deg, #132238, #1e3a5f);
    }

    [data-theme="space"] {
      --bg-primary: #0a0e17;
      --bg-secondary: #0f1525;
      --text-primary: #e9ecef;
      --text-secondary: #8b9bb4;
      --card-bg: #131c2f;
      --border-color: #24334d;
      --header-bg: linear-gradient(135deg, #131c2f, #1e2f4f);
    }

    [data-theme="neon"] {
      --bg-primary: #0a0a0a;
      --bg-secondary: #111;
      --text-primary: #18dcff;
      --text-secondary: #ff4d8d;
      --card-bg: #1a1a1a;
      --border-color: #333;
      --header-bg: linear-gradient(135deg, #18dcff, #7158e2);
    }

    [data-theme="energy"] {
      --bg-primary: #fffdf5;
      --bg-secondary: #fdf2d5;
      --text-primary: #222;
      --text-secondary: #555;
      --card-bg: #fff9e6;
      --border-color: #f0d9b5;
      --header-bg: linear-gradient(135deg, #ffd166, #ff4d8d);
    }

    [data-theme="sleep"] {
      --bg-primary: #001f3f;
      --bg-secondary: #012a4a;
      --text-primary: #cce7ff;
      --text-secondary: #8aaacb;
      --card-bg: #013a63;
      --border-color: #01497c;
      --header-bg: linear-gradient(135deg, #001f3f, #013a63);
    }

    /* =============================
       üåü ÿßŸÑŸáŸäÿØÿ± + ÿ®ÿÆÿßÿ± ÿßŸÑŸÉŸàÿ®
    ============================== */
    header {
      background: var(--header-bg);
      padding: 20px;
      border-radius: 16px;
      margin: 20px auto;
      max-width: 1400px;
      color: white;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
      position: relative;
      overflow: hidden;
    }

    .brand {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
      font-size: 2.2rem;
      font-weight: 800;
    }

    .brand i {
      color: var(--neon-blue);
      filter: drop-shadow(0 0 5px var(--neon-blue));
    }

    .coffee-steam {
      display: inline-block;
      margin-left: 10px;
      position: relative;
    }

    .steam {
      position: absolute;
      height: 20px;
      width: 20px;
      border-radius: 50%;
      background: linear-gradient(to bottom, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.1));
      margin-top: -25px;
      margin-left: 5px;
      opacity: 0;
    }

    .steam.one { animation: steam-one 4s ease-out infinite; }
    .steam.two { animation: steam-two 4s ease-out 1s infinite; }
    .steam.three { animation: steam-three 4s ease-out 2s infinite; }

    @keyframes steam-one {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-50px) translateX(-10px) scale(1.5); opacity: 0; }
    }

    @keyframes steam-two {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-45px) translateX(10px) scale(1.5); opacity: 0; }
    }

    @keyframes steam-three {
      0% { transform: translateY(0) scale(0.3); opacity: 0.6; }
      100% { transform: translateY(-40px) translateX(-5px) scale(1.5); opacity: 0; }
    }

    /* =============================
       üîç ÿßŸÑÿ®ÿ≠ÿ´ + ÿßŸÑŸÅŸÑÿßÿ™ÿ±
    ============================== */
    .search-panel {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      padding: 20px;
      margin: 20px auto;
      max-width: 1200px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }

    .search-input {
      display: flex;
      gap: 10px;
    }

    .search-input input {
      flex: 1;
      padding: 12px 18px;
      border-radius: 10px;
      border: 1px solid var(--border-color);
      background: var(--bg-secondary);
      color: var(--text-primary);
      font-size: 1rem;
    }

    .btn-search {
      background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-weight: 700;
      cursor: pointer;
    }

    .filters {
      margin-top: 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
    }

    .filter-item {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 20px;
      padding: 8px 15px;
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 0.9rem;
    }

    /* =============================
       üó∫Ô∏è ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ©
    ============================== */
    .map-container {
      margin: 20px auto;
      max-width: 1200px;
      height: 550px;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid var(--border-color);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.4);
    }

    #map { width: 100%; height: 100%; }

  </style>
</head>
<body data-theme="space" class="space-theme">

  <!-- üåå ÿßŸÑŸáŸäÿØÿ± -->
  <header>
    <div class="brand">
      <i class="fas fa-mug-hot"></i>
      Coffee Finder Pro
      <div class="coffee-steam">
        <div class="steam one"></div>
        <div class="steam two"></div>
        <div class="steam three"></div>
      </div>
    </div>
  </header>

  <!-- üîç ŸÑŸàÿ≠ÿ© ÿßŸÑÿ®ÿ≠ÿ´ -->
  <section class="search-panel">
    <div class="search-input">
      <input type="text" id="searchInput" placeholder="Search for a city in Saudi Arabia..." />
      <button class="btn-search" id="searchBtn"><i class="fas fa-search"></i> Search</button>
    </div>
    <div class="filters">
      <div class="filter-item"><input type="checkbox" id="wifi"><label for="wifi">Wi-Fi</label></div>
      <div class="filter-item"><input type="checkbox" id="outdoor"><label for="outdoor">Outdoor</label></div>
      <div class="filter-item"><input type="checkbox" id="parking"><label for="parking">Parking</label></div>
      <div class="filter-item"><input type="checkbox" id="openNow"><label for="openNow">Open Now</label></div>
      <div class="filter-item">
        <label for="radius">Radius:</label>
        <select id="radius">
          <option value="1000">1 km</option>
          <option value="3000" selected>3 km</option>
          <option value="5000">5 km</option>
          <option value="10000">10 km</option>
        </select>
      </div>
    </div>
  </section>

  <!-- üó∫Ô∏è ÿßŸÑÿÆÿ±Ÿäÿ∑ÿ© -->
  <section class="map-container">
    <div id="map"></div>
  </section>
  <!-- ‚òï ŸÜÿ™ÿßÿ¶ÿ¨ ÿßŸÑŸÖŸÇÿßŸáŸä -->
  <section class="results-section container">
    <div class="results-header d-flex justify-content-between align-items-center mb-4 p-3"
         style="background: var(--card-bg); border-radius:12px; border:1px solid var(--border-color);">
      <h2 class="results-count">Found <span id="resultsNumber">0</span> coffee shops</h2>
      <select class="sort-select" id="sortSelect">
        <option value="distance">Closest First</option>
        <option value="rating">Highest Rated</option>
        <option value="name">By Name</option>
      </select>
    </div>

    <div class="cafe-list" id="cafeList"
         style="display:grid; grid-template-columns:repeat(auto-fill, minmax(320px,1fr)); gap:25px; margin-bottom:40px;">
      <!-- ÿßŸÑŸÉÿ±Ÿàÿ™ ÿ≥ÿ™ÿ∏Ÿáÿ± ŸáŸÜÿß ÿØŸäŸÜÿßŸÖŸäŸÉŸäÿßŸã -->
    </div>
  </section>

  <style>
    /* =============================
       üé¥ ŸÉÿ±Ÿàÿ™ ÿßŸÑŸÖŸÇÿßŸáŸä
    ============================== */
    .cafe-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 16px;
      overflow: hidden;
      transition: all 0.3s;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      opacity: 0;
      transform: translateY(30px);
    }
    .cafe-card.show {
      opacity: 1;
      transform: translateY(0);
      transition: all 0.6s ease;
    }
    .cafe-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 12px 30px rgba(0,0,0,0.5);
      border-color: var(--neon-blue);
    }

    .cafe-image {
      height: 200px;
      background: linear-gradient(135deg, var(--coffee-light), var(--coffee-dark));
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      overflow: hidden;
    }
    .cafe-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s ease;
    }
    .cafe-card:hover .cafe-image img {
      transform: scale(1.1);
    }

    .cafe-info {
      padding: 20px;
    }
    .cafe-name {
      font-weight: 800;
      font-size: 1.3rem;
      margin-bottom: 10px;
      color: var(--text-primary);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .cafe-meta {
      display: flex;
      gap: 15px;
      font-size: 0.95rem;
      color: var(--text-secondary);
      margin-bottom: 12px;
    }
    .rating { color: var(--warning); font-weight: bold; }

    .cafe-features {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      margin-bottom: 15px;
    }
    .feature-tag {
      font-size: 0.85rem;
      padding: 5px 12px;
      border-radius: 15px;
      border: 1px solid rgba(255,255,255,0.2);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .feature-tag.wifi {
      background: rgba(24,220,255,0.15);
      color: var(--neon-blue);
    }
    .feature-tag.outdoor {
      background: rgba(255,209,102,0.15);
      color: var(--warning);
    }
    .feature-tag.parking {
      background: rgba(0,255,140,0.15);
      color: var(--success);
    }
    .feature-tag.snacks {
      background: rgba(255,77,141,0.15);
      color: var(--neon-pink);
    }

    .cafe-actions {
      display: flex;
      gap: 10px;
    }
    .action-btn {
      flex: 1;
      padding: 10px 16px;
      border-radius: 10px;
      font-weight: 700;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 6px;
      transition: all 0.3s;
    }
    .action-btn.directions {
      background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
      color: white;
    }
    .action-btn.details {
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      color: var(--text-primary);
    }
    .action-btn.favorite {
      background: rgba(255,77,141,0.15);
      color: var(--neon-pink);
      border: 1px solid rgba(255,77,141,0.4);
    }
    .action-btn:hover {
      transform: translateY(-3px);
      box-shadow: 0 5px 15px rgba(0,0,0,0.2);
    }
  </style>

  <script>
    // =============================
    // üé≤ ÿ®ŸäÿßŸÜÿßÿ™ ÿ™ÿ¨ÿ±Ÿäÿ®Ÿäÿ© ŸÑŸÑŸÖŸÇÿßŸáŸä
    // =============================
    const cafeData = [
      {
        name: "Arabica Coffee",
        address: "Al Malaz, Riyadh",
        lat: 24.7136, lng: 46.6753,
        rating: 4.5,
        distance: 1.2,
        open: true,
        features: ["wifi", "outdoor"],
        image: "https://images.unsplash.com/photo-1554118811-1e0d58224f24"
      },
      {
        name: "Starbucks Riyadh",
        address: "Sulimaniyah, Riyadh",
        lat: 24.7612, lng: 46.6753,
        rating: 4.7,
        distance: 0.8,
        open: true,
        features: ["wifi", "parking"],
        image: "https://images.unsplash.com/photo-1509042239860-f550ce710b93"
      },
      {
        name: "Deem Coffee",
        address: "Al Olaya, Riyadh",
        lat: 24.6932, lng: 46.6915,
        rating: 4.3,
        distance: 2.3,
        open: true,
        features: ["outdoor", "snacks"],
        image: "https://images.unsplash.com/photo-1463797221720-6b07e6426c24"
      }
    ];

    // =============================
    // üñºÔ∏è ÿπÿ±ÿ∂ ÿ®ÿ∑ÿßŸÇÿßÿ™ ÿßŸÑŸÖŸÇÿßŸáŸä
    // =============================
    function renderCafeList() {
      const cafeList = document.getElementById("cafeList");
      cafeList.innerHTML = "";
      document.getElementById("resultsNumber").textContent = cafeData.length;

      cafeData.forEach((cafe, index) => {
        const card = document.createElement("div");
        card.className = "cafe-card";
        card.innerHTML = `
          <div class="cafe-image">
            <img src="${cafe.image}" alt="${cafe.name}">
          </div>
          <div class="cafe-info">
            <h3 class="cafe-name">${cafe.name}
              <span class="rating"><i class="fas fa-star"></i> ${cafe.rating}</span>
            </h3>
            <div class="cafe-meta">
              <span><i class="fas fa-map-marker-alt"></i> ${cafe.address}</span>
              <span><i class="fas fa-road"></i> ${cafe.distance} km</span>
              <span><i class="fas fa-clock"></i> ${cafe.open ? "Open" : "Closed"}</span>
            </div>
            <div class="cafe-features">
              ${cafe.features.includes("wifi") ? `<span class="feature-tag wifi"><i class="fas fa-wifi"></i> Wi-Fi</span>` : ""}
              ${cafe.features.includes("outdoor") ? `<span class="feature-tag outdoor"><i class="fas fa-umbrella-beach"></i> Outdoor</span>` : ""}
              ${cafe.features.includes("parking") ? `<span class="feature-tag parking"><i class="fas fa-car"></i> Parking</span>` : ""}
              ${cafe.features.includes("snacks") ? `<span class="feature-tag snacks"><i class="fas fa-utensils"></i> Snacks</span>` : ""}
            </div>
            <div class="cafe-actions">
              <button class="action-btn directions"><i class="fas fa-route"></i> Directions</button>
              <button class="action-btn details"><i class="fas fa-info-circle"></i> Details</button>
              <button class="action-btn favorite"><i class="fas fa-heart"></i> Favorite</button>
            </div>
          </div>
        `;
        cafeList.appendChild(card);

        // ÿßŸÜŸäŸÖŸäÿ¥ŸÜ ÿßŸÑÿ∏ŸáŸàÿ±
        setTimeout(() => card.classList.add("show"), index * 150);
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      renderCafeList();
    });
  </script>
  <!-- ü§ñ Chatbot -->
  <div class="chatbot-container" style="position:fixed; bottom:30px; left:30px; z-index:1000;">
    <button class="chatbot-toggle" id="chatbotToggle"
            style="width:60px; height:60px; border-radius:50%; background:linear-gradient(135deg,var(--neon-pink),var(--space-purple));
                   color:white; border:none; font-size:24px; box-shadow:0 4px 20px rgba(255,77,141,0.4);">
      <i class="fas fa-robot"></i>
    </button>
    <div class="chatbot-window" id="chatbotWindow"
         style="display:none; flex-direction:column; position:absolute; bottom:70px; left:0; width:350px; height:450px;
                background:var(--card-bg); border:1px solid var(--border-color); border-radius:16px; box-shadow:0 4px 20px rgba(0,0,0,0.5);">
      <div class="chatbot-header d-flex justify-content-between align-items-center p-2"
           style="background:var(--bg-secondary); border-bottom:1px solid var(--border-color);">
        <h5 class="m-0">Coffee Assistant</h5>
        <button class="btn-close" id="closeChatbot"></button>
      </div>
      <div class="chatbot-messages flex-grow-1 p-3" id="chatbotMessages"
           style="overflow-y:auto; display:flex; flex-direction:column; gap:10px;"></div>
      <div class="chatbot-input d-flex p-2" style="border-top:1px solid var(--border-color); gap:8px;">
        <input type="text" id="chatbotInput" placeholder="Type here..."
               style="flex:1; border-radius:20px; border:1px solid var(--border-color); padding:8px 12px;">
        <button id="sendMessage"
                style="width:45px; height:45px; border-radius:50%; border:none;
                       background:linear-gradient(135deg,var(--neon-blue),var(--space-purple)); color:white;">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- üîî ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™ -->
  <div id="notifications"></div>
  <style>
    #notifications {
      position: fixed;
      top: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
      z-index: 2000;
    }
    .notification {
      padding: 12px 18px;
      border-radius: 10px;
      font-weight: 600;
      color: white;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      animation: slideIn 0.4s ease;
    }
    @keyframes slideIn {
      from { transform: translateX(120%); opacity:0; }
      to   { transform: translateX(0); opacity:1; }
    }
    .notification.success { background:linear-gradient(135deg,#00ff8c,#00b36b); }
    .notification.error   { background:linear-gradient(135deg,#ff6b6b,#cc5555); }
    .notification.info    { background:linear-gradient(135deg,#18dcff,#7158e2); }
  </style>

  <script>
    // =============================
    // üîî ÿ•ÿ¥ÿπÿßÿ±ÿßÿ™
    // =============================
    function showNotification(message, type="info") {
      const container = document.getElementById("notifications");
      const n = document.createElement("div");
      n.className = `notification ${type}`;
      n.textContent = message;
      container.appendChild(n);
      setTimeout(()=> { n.style.opacity=0; setTimeout(()=>n.remove(),500); }, 3000);
    }

    // =============================
    // ü§ñ Chatbot
    // =============================
    function addChatMessage(text, sender="bot") {
      const messages = document.getElementById("chatbotMessages");
      const div = document.createElement("div");
      div.className = "message " + sender;
      div.style.cssText = `
        padding:10px 15px;
        border-radius:15px;
        max-width:80%;
        line-height:1.4;
      `;
      if(sender==="bot"){
        div.style.background="var(--bg-secondary)";
        div.style.alignSelf="flex-start";
        div.style.color="var(--text-primary)";
      } else {
        div.style.background="linear-gradient(135deg,var(--neon-blue),var(--space-purple))";
        div.style.color="white";
        div.style.alignSelf="flex-end";
      }
      div.textContent = text;
      messages.appendChild(div);
      messages.scrollTop = messages.scrollHeight;
    }

    const botResponses = [
      "Hello! How can I help you find coffee?",
      "Looking for Wi-Fi or outdoor seating?",
      "I can recommend top rated cafes nearby.",
      "Would you like espresso or latte style places?",
      "Searching... give me a second!"
    ];

    document.getElementById("chatbotToggle").addEventListener("click", ()=>{
      const w = document.getElementById("chatbotWindow");
      w.style.display = w.style.display==="flex" ? "none":"flex";
    });
    document.getElementById("closeChatbot").addEventListener("click", ()=>{
      document.getElementById("chatbotWindow").style.display="none";
    });
    document.getElementById("sendMessage").addEventListener("click", ()=>{
      const input = document.getElementById("chatbotInput");
      const msg = input.value.trim();
      if(!msg) return;
      addChatMessage(msg,"user");
      input.value="";
      setTimeout(()=>{
        const r = botResponses[Math.floor(Math.random()*botResponses.length)];
        addChatMessage(r,"bot");
      },800);
    });

    // =============================
    // üéÆ Gamification + Confetti
    // =============================
    let points = 0;
    function addPoints(p=10) {
      points += p;
      if(points % 50 === 0) {
        showNotification(`Level Up! üåü You now have ${points} points!`,"success");
        launchConfetti();
      } else {
        showNotification(`+${p} points! Total: ${points}`,"info");
      }
    }

    function launchConfetti() {
      const duration = 2 * 1000;
      const end = Date.now() + duration;
      (function frame() {
        const confetti = document.createElement("div");
        confetti.style.position="fixed";
        confetti.style.left=Math.random()*100+"vw";
        confetti.style.top="0px";
        confetti.style.width="10px";
        confetti.style.height="10px";
        confetti.style.borderRadius="50%";
        confetti.style.background=`hsl(${Math.random()*360},100%,50%)`;
        confetti.style.opacity=0.8;
        confetti.style.zIndex=3000;
        document.body.appendChild(confetti);
        const fall = setInterval(()=>{
          const top = parseFloat(confetti.style.top);
          if(top > window.innerHeight) { confetti.remove(); clearInterval(fall);}
          confetti.style.top = top+5+"px";
        },30);
        if(Date.now()<end) requestAnimationFrame(frame);
      })();
    }

    // ÿ±ÿ®ÿ∑ ÿßŸÑŸÖŸÅÿ∂ŸÑÿ© ŸÖÿπ ÿßŸÑŸÜŸÇÿßÿ∑
    document.addEventListener("click",(e)=>{
      if(e.target.closest(".action-btn.favorite")){
        addPoints(20);
        showNotification("Added to favorites ‚ù§Ô∏è","success");
      }
    });
  </script>

  <!-- üåå ŸÖÿ§ÿ´ÿ±ÿßÿ™ ÿ•ÿ∂ÿßŸÅŸäÿ© -->
  <style>
    .neon-text {
      text-shadow: 0 0 5px var(--neon-blue),
                   0 0 10px var(--neon-pink),
                   0 0 15px var(--neon-blue),
                   0 0 20px var(--space-purple);
    }
    .glitch {
      position: relative;
      color: white;
      font-size: 2rem;
      font-weight: bold;
    }
    .glitch::before,
    .glitch::after {
      content: attr(data-text);
      position: absolute;
      left: 0; top: 0;
      width: 100%; overflow: hidden;
    }
    .glitch::before {
      left: 2px; text-shadow: -2px 0 red; animation: glitch 2s infinite linear alternate-reverse;
    }
    .glitch::after {
      left: -2px; text-shadow: -2px 0 blue; animation: glitch 1.5s infinite linear alternate-reverse;
    }
    @keyframes glitch {
      0% { clip: rect(44px,9999px,56px,0); }
      20% { clip: rect(12px,9999px,80px,0); }
      40% { clip: rect(85px,9999px,140px,0); }
      60% { clip: rect(24px,9999px,70px,0); }
      80% { clip: rect(50px,9999px,90px,0); }
      100% { clip: rect(10px,9999px,130px,0); }
    }
  </style>
 
  <!-- üåê ŸÖÿ®ÿØŸÑ ÿßŸÑŸÑÿ∫ÿ© -->
  <div class="language-switcher" style="position:fixed; top:20px; right:20px; z-index:2000;">
    <button id="langToggle"
            style="padding:8px 14px; border:none; border-radius:20px; background:rgba(255,255,255,0.2);
                   color:white; cursor:pointer; backdrop-filter:blur(10px);">
      ÿßŸÑÿπÿ±ÿ®Ÿäÿ©
    </button>
  </div>

  <script>
       // =============================
    // üó∫Ô∏è ÿßŸÑÿ®ÿ≠ÿ´ (Nominatim + Overpass)
    // =============================
    async function searchCity(query) {
      try {
        const url = `https://nominatim.openstreetmap.org/search?format=json&q=${query}, Saudi Arabia`;
        const res = await fetch(url);
        const data = await res.json();
        if(data && data.length>0){
          const {lat, lon, display_name} = data[0];
          map.setView([lat,lon], 13);
          showNotification(`Found ${display_name}`,"success");
          getWeather(display_name);
          fetchCafes(lat,lon);
        } else {
          showNotification("City not found","error");
        }
      } catch(err){
        showNotification("Search error","error");
      }
    }

    async function fetchCafes(lat,lon){
      const overpassUrl = "https://overpass-api.de/api/interpreter";
      const radius = document.getElementById("radius").value || 3000;
      const query = `
        [out:json];
        (
          node["amenity"="cafe"](around:${radius},${lat},${lon});
        );
        out;
      `;
      try {
        const res = await fetch(overpassUrl, {method:"POST", body:query});
        const data = await res.json();
        cafeData.length = 0; // clear
        data.elements.forEach(el=>{
          cafeData.push({
            name: el.tags.name || "Unnamed Cafe",
            address: el.tags["addr:street"] || "Unknown",
            lat: el.lat,
            lng: el.lon,
            rating: (Math.random()*2+3).toFixed(1),
            distance: Math.floor(Math.random()*5)+1,
            open: Math.random()>0.3,
            features: ["wifi","outdoor","snacks"].filter(()=>Math.random()>0.5),
            image: "https://source.unsplash.com/400x300/?coffee,cafe"
          });
        });
        renderCafeList();
        showNotification(`Loaded ${cafeData.length} cafes`,"success");
      } catch(err){
        showNotification("Failed to load cafes","error");
      }
    }

    // ÿ±ÿ®ÿ∑ ÿ≤ÿ± ÿßŸÑÿ®ÿ≠ÿ´
    document.getElementById("searchBtn").addEventListener("click",()=>{
      const q = document.getElementById("searchInput").value.trim();
      if(q) searchCity(q);
    });
    document.getElementById("searchInput").addEventListener("keypress",(e)=>{
      if(e.key==="Enter"){
        const q = document.getElementById("searchInput").value.trim();
        if(q) searchCity(q);
      }
    });

    // =============================
    // ‚ö° ÿ¥ÿ±Ÿäÿ∑ ÿßŸÑÿ∑ÿßŸÇÿ©
    // =============================
    window.addEventListener("scroll",()=>{
      const h = document.documentElement;
      const st = h.scrollTop;
      const sh = h.scrollHeight - h.clientHeight;
      const p = (st/sh)*100;
      document.querySelector(".energy-bar").style.width = p+"%";
    });

    // =============================
    // üåê ÿ™ÿπÿØÿØ ÿßŸÑŸÑÿ∫ÿßÿ™
    // =============================
    let lang="en";
    document.getElementById("langToggle").addEventListener("click",()=>{
      lang = (lang==="en"?"ar":"en");
      if(lang==="ar"){
        document.body.dir="rtl";
        document.getElementById("langToggle").textContent="English";
        showNotification("ÿ™ŸÖ ÿßŸÑÿ™ÿ®ÿØŸäŸÑ ÿ•ŸÑŸâ ÿßŸÑÿπÿ±ÿ®Ÿäÿ©","info");
      } else {
        document.body.dir="ltr";
        document.getElementById("langToggle").textContent="ÿßŸÑÿπÿ±ÿ®Ÿäÿ©";
        showNotification("Language switched to English","info");
      }
    });

    // =============================
    // üì§ ŸÖÿ¥ÿßÿ±ŸÉÿ© + QR
    // =============================
    function shareCafe(cafe){
      const url = `https://www.google.com/maps?q=${cafe.lat},${cafe.lng}`;
      if(navigator.share){
        navigator.share({title:cafe.name, text:"Check this cafe!", url});
      } else {
        prompt("Copy this link:",url);
      }
    }

    function generateQR(cafe){
      const qrUrl = `https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${encodeURIComponent(cafe.name+" "+cafe.lat+","+cafe.lng)}`;
      const w = window.open("","_blank","width=200,height=200");
      w.document.write(`<img src="${qrUrl}" alt="QR Code">`);
    }

    // ÿ™ÿ≠ÿØŸäÿ´ ÿßŸÑÿ®ÿ∑ÿßŸÇÿßÿ™ ŸÑÿßÿ∂ÿßŸÅÿ© ÿ≤ÿ± ŸÖÿ¥ÿßÿ±ŸÉÿ© Ÿà QR
    function renderCafeList(){
      const cafeList = document.getElementById("cafeList");
      cafeList.innerHTML="";
      document.getElementById("resultsNumber").textContent=cafeData.length;
      cafeData.forEach((cafe,index)=>{
        const card = document.createElement("div");
        card.className="cafe-card";
        card.innerHTML=`
          <div class="cafe-image"><img src="${cafe.image}" alt="${cafe.name}"></div>
          <div class="cafe-info">
            <h3 class="cafe-name">${cafe.name}<span class="rating"><i class="fas fa-star"></i> ${cafe.rating}</span></h3>
            <div class="cafe-meta">
              <span><i class="fas fa-map-marker-alt"></i> ${cafe.address}</span>
              <span><i class="fas fa-road"></i> ${cafe.distance} km</span>
              <span><i class="fas fa-clock"></i> ${cafe.open?"Open":"Closed"}</span>
            </div>
            <div class="cafe-features">
              ${cafe.features.map(f=>`<span class="feature-tag ${f}">${f}</span>`).join("")}
            </div>
            <div class="cafe-actions">
              <button class="action-btn directions" onclick="window.open('https://www.google.com/maps?q=${cafe.lat},${cafe.lng}','_blank')"><i class="fas fa-route"></i> Directions</button>
              <button class="action-btn details" onclick="alert('Details about ${cafe.name}')"><i class="fas fa-info-circle"></i> Details</button>
              <button class="action-btn favorite"><i class="fas fa-heart"></i> Favorite</button>
              <button class="action-btn" onclick='shareCafe(${JSON.stringify(cafe)})'><i class="fas fa-share"></i> Share</button>
              <button class="action-btn" onclick='generateQR(${JSON.stringify(cafe)})'><i class="fas fa-qrcode"></i> QR</button>
            </div>
          </div>
        `;
        cafeList.appendChild(card);
        setTimeout(()=>card.classList.add("show"),index*100);
      });
    }

    // =============================
    // üìÇ Offline Mode
    // =============================
    window.addEventListener("offline",()=>{
      showNotification("‚ö†Ô∏è You are offline!","error");
    });
    window.addEventListener("online",()=>{
      showNotification("‚úÖ Back online!","success");
    });

    // =============================
    // üéÆ Easter Egg
    // =============================
    document.addEventListener("keydown",(e)=>{
      if(e.ctrlKey && e.shiftKey && e.code==="KeyC"){
        const egg=document.createElement("div");
        egg.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:black;color:lime;font-size:2rem;display:flex;align-items:center;justify-content:center;z-index:5000;";
        egg.textContent="‚òï The Coffee Matrix has you... ‚òï";
        document.body.appendChild(egg);
        setTimeout(()=>egg.remove(),4000);
      }
    });
  </script>

  <!-- =============================
       üë£ Footer
  ============================== -->
  <footer class="text-center p-4 mt-5" style="color:var(--text-secondary); border-top:1px solid var(--border-color);">
    <p>¬© 2025 Coffee Finder Pro ‚Äî Sci-Fi Edition</p>
    <p>Discover the best coffee shops across Saudi Arabia</p>
  </footer>

  <!-- ŸÖŸÉÿ™ÿ®ÿßÿ™ JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
</html>

<!-- ====================== PART 7 START ====================== -->
<!-- Theme Generator + Heatmap + Video Background + Events + Compass + Sticky Notes -->

<!-- Video Background -->
<video autoplay muted loop id="videoBackground">
  <source src="https://cdn.coverr.co/videos/coverr-coffee-beans-8177/1080p.mp4" type="video/mp4">
</video>

<!-- Heatmap -->
<section class="heatmap-section">
  <h2>üåç Coffee Heatmap</h2>
  <div id="heatmapMap" style="height:400px; border-radius:16px;"></div>
</section>

<!-- Events Calendar -->
<section class="events-calendar">
  <h2>üìÖ Coffee Events Calendar</h2>
  <div id="calendar"></div>
</section>

<!-- Compass -->
<div id="compassContainer">
  <div id="compass">
    <div id="needle"></div>
  </div>
</div>

<!-- Sticky Notes -->
<section class="sticky-notes">
  <h2>üìå Sticky Notes</h2>
  <textarea id="noteInput" placeholder="Write your note..."></textarea>
  <button id="saveNote">Save Note</button>
  <div id="notesList"></div>
</section>

<style>
/* Video Background */
#videoBackground {
  position: fixed; top:0; left:0;
  width:100%; height:100%;
  object-fit: cover;
  z-index:-5;
  opacity:0.25;
}

/* Heatmap */
.heatmap-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px; }

/* Compass */
#compassContainer {
  position:fixed; top:20px; left:20px; z-index:2000;
}
#compass {
  width:80px; height:80px; border:4px solid #fff; border-radius:50%;
  position:relative; background:rgba(0,0,0,0.4);
}
#needle {
  width:2px; height:35px; background:red;
  position:absolute; top:5px; left:50%;
  transform-origin: bottom center;

<script src="https://unpkg.com/leaflet.heat/dist/leaflet-heat.js"></script>

<script>
// ========== Theme Generator ==========
document.getElementById("applyTheme").onclick=()=>{
  document.documentElement.style.setProperty("--primary",document.getElementById("primaryColor").value);
  document.documentElement.style.setProperty("--secondary",document.getElementById("secondaryColor").value);
  document.documentElement.style.setProperty("--accent",document.getElementById("accentColor").value);
  showNotification("Theme updated!","success");
};

// ========== Heatmap ==========
const heatmap=L.map("heatmapMap").setView([24.7136,46.6753],12);
L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png").addTo(heatmap);
const heatData=[
  [24.7136,46.6753,0.8],[24.7216,46.6553,0.7],
  [24.7812,46.6912,0.9],[24.7523,46.7001,0.6],
  [24.6932,46.6915,0.5]
];
L.heatLayer(heatData,{radius:25}).addTo(heatmap);

// ========== Events Calendar ==========
function generateCalendar(){
  const cal=document.getElementById("calendar");
  cal.innerHTML="";
  const days=30;
  const events={5:"‚òï Latte Festival",12:"üé∂ Jazz Night",18:"üç™ Cookies & Coffee",25:"üî• Barista Show"};
  for(let i=1;i<=days;i++){
    const div=document.createElement("div");
    div.textContent=i;
    if(events[i]){ div.classList.add("event"); div.title=events[i]; }
    cal.appendChild(div);
  }
}
generateCalendar();

// ========== Compass ==========
if(window.DeviceOrientationEvent){
  window.addEventListener("deviceorientation",function(event){
    const alpha=event.alpha;
    document.getElementById("needle").style.transform=`rotate(${alpha}deg)`;
  },true);
}

<!-- ====================== PART 8 START ====================== -->
<!-- 3D Gallery + Mapbox + Charts + Extra Games + TTS + Offline Mode + Sci-Fi Mode -->

<!-- 3D Gallery -->
<section class="gallery">
  <h2>üñº Coffee 3D Gallery</h2>
  <div class="gallery-carousel" id="galleryCarousel">
    <img src="https://images.unsplash.com/photo-1509042239860-f550ce710b93" alt="Coffee 1">
    <img src="https://images.unsplash.com/photo-1527169402691-a097c6f1b9ad" alt="Coffee 2">
    <img src="https://images.unsplash.com/photo-1495474472287-4d71bcdd2085" alt="Coffee 3">
    <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24" alt="Coffee 4">
  </div>
</section>

<!-- Mapbox -->
<section class="mapbox-section">
  <h2>üõ∞ Sci-Fi Map</h2>
  <div id="mapboxMap" style="height:400px; border-radius:16px;"></div>
</section>

<!-- Extra Games -->
<section class="extra-games">
  <h2>üß© Coffee Games</h2>
  <div class="memory-game" id="memoryGame"></div>
  <div class="quiz">
    <h3>‚òï Coffee Quiz</h3>
    <p id="quizQuestion"></p>
    <div id="quizOptions"></div>
  </div>
</section>

<style>
/* Gallery */
.gallery { margin:50px 0; text-align:center; }
.gallery-carousel { display:flex; gap:20px; overflow-x:auto; padding:20px; }
.gallery-carousel img {
  width:250px; height:180px; object-fit:cover;
  border-radius:12px; transition:transform 0.5s;
}
.gallery-carousel img:hover { transform:rotateY(20deg) scale(1.1); }

/* Mapbox */
.mapbox-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px; }

/* TTS */
.tts-section { margin:50px 0; padding:20px; background:var(--card-bg); border-radius:16px;}
.tts-section textarea { width:100%; height:100px; margin-bottom:10px; padding:10px; }

/* Offline */
#offlineAlert {
  position:fixed; top:0; left:0; right:0;
  background:#ff6b6b; color:white;
  text-align:center; padding:10px;
  display:none; z-index:3000;
}

<script src="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.js"></script>
<link href="https://api.mapbox.com/mapbox-gl-js/v2.3.1/mapbox-gl.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
// ========== Mapbox ==========
mapboxgl.accessToken='pk.eyJ1IjoibWFwYm94dXNlciIsImEiOiJja2xnaWxqdmwwMDRnMm9ucnJ6YnZrNjJwIn0.6D0xLugUVxZ6RVcZ9I8A5g';
const mapboxMap=new mapboxgl.Map({
  container:'mapboxMap',
  style:'mapbox://styles/mapbox/dark-v10',
  center:[46.6753,24.7136], zoom:10

 <!-- ====================== PART 9 START ====================== -->
        <!-- ================= EXTRA FEATURES PART 1 ================= -->
        <!-- Dynamic Galaxy Background Layer -->
        <div id="galaxy-bg"></div>

        <style>
            /* Galaxy Background */
            #galaxy-bg {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -2;
                overflow: hidden;
                background: black;
            }

            .star {
                position: absolute;
                background: white;
                border-radius: 50%;
                opacity: 0.8;
                animation: twinkle 3s infinite ease-in-out;
            }

            @keyframes twinkle {
                0% { opacity: 0.2; transform: scale(0.5); }
                50% { opacity: 1; transform: scale(1); }
                100% { opacity: 0.2; transform: scale(0.5); }
            }

            .shooting-star {
                position: absolute;
                width: 2px;
                height: 100px;
                background: linear-gradient(180deg, white, transparent);
                opacity: 0.8;
                animation: shoot 2s linear forwards;
            }

            @keyframes shoot {
                0% { transform: translateY(-200px) translateX(0); opacity: 1; }
                100% { transform: translateY(800px) translateX(200px); opacity: 0; }
            }
        </style>

        <script>
            // Add random stars to galaxy
            function createStars() {
                const galaxy = document.getElementById("galaxy-bg");
                for (let i = 0; i < 120; i++) {
                    const star = document.createElement("div");
                    star.classList.add("star");
                    const size = Math.random() * 3;
                    star.style.width = `${size}px`;
                    star.style.height = `${size}px`;
                    star.style.top = `${Math.random() * window.innerHeight}px`;
                    star.style.left = `${Math.random() * window.innerWidth}px`;
                    star.style.animationDuration = `${2 + Math.random() * 3}s`;
                    galaxy.appendChild(star);
                }
            }

            // Shooting star
            function shootingStar() {
                const galaxy = document.getElementById("galaxy-bg");
                const star = document.createElement("div");
                star.classList.add("shooting-star");
                star.style.left = `${Math.random() * window.innerWidth}px`;
                galaxy.appendChild(star);

                setTimeout(() => {
                    galaxy.removeChild(star);
                }, 2000);
            }

            createStars();
            setInterval(shootingStar, 6000);
        </script>

              <!-- Scroll Progress Bar -->
        <div id="scroll-progress"></div>

        <style>
            #scroll-progress {
                position: fixed;
                top: 0;
                left: 0;
                height: 5px;
                background: linear-gradient(90deg, var(--neon-blue), var(--neon-pink));
                width: 0%;
                z-index: 2000;
            }
        </style>

        <script>
            // Scroll progress
            window.addEventListener("scroll", () => {
                const scrollTop = document.documentElement.scrollTop;
                const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
                const scrolled = (scrollTop / scrollHeight) * 100;
                document.getElementById("scroll-progress").style.width = scrolled + "%";
            });
        </script>

        <!-- Back to Top Button -->
        <button id="backToTop"><i class="fas fa-arrow-up"></i></button>

        <style>
            #backToTop {
                position: fixed;
                bottom: 80px;
                right: 30px;
                width: 50px;
                height: 50px;
                border-radius: 50%;
                border: none;
                background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
                color: white;
                font-size: 20px;
                display: none;
                cursor: pointer;
                z-index: 2000;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
                transition: all 0.3s;
            }
            #backToTop:hover {
                transform: scale(1.1);
                box-shadow: 0 6px 20px rgba(0,0,0,0.5);
            }
        </style>

        <script>
            const backToTopBtn = document.getElementById("backToTop");
            window.addEventListener("scroll", () => {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = "block";
                } else {
                    backToTopBtn.style.display = "none";
                }
            });

            backToTopBtn.addEventListener("click", () => {
                window.scrollTo({ top: 0, behavior: "smooth" });
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 1 ================= -->
               <script>
            // Free Weather using Open-Meteo API
            async function loadWeather() {
                try {
                    const lat = 24.7136;
                    const lon = 46.6753;
                    const res = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`);
                    const data = await res.json();
                    document.getElementById("weather-temp").textContent = data.current_weather.temperature + " ¬∞C";
                    document.getElementById("weather-condition").textContent = "Wind " + data.current_weather.windspeed + " km/h";
                } catch (e) {
                    document.getElementById("weather-condition").textContent = "Weather unavailable";
                }
            }
            loadWeather();
        </script>

        <!-- Daily Quote Widget -->
        <div id="quote-widget" class="quote-widget">
            <h4><i class="fas fa-quote-left"></i> Daily Quote</h4>
            <p id="daily-quote">Loading...</p>
        </div>

        <style>
            .quote-widget {
                position: fixed;
                bottom: 20px;
                left: 20px;
                background: var(--card-bg);
                padding: 15px 20px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                border: 1px solid var(--border-color);
                z-index: 999;
                width: 250px;
                font-size: 0.9rem;
                color: var(--text-primary);
            }
            .quote-widget h4 {
                margin-bottom: 8px;
                font-weight: 700;
            }
        </style>

        <script>
            // Free API for quotes
            async function loadQuote() {
                try {
                    const res = await fetch("https://type.fit/api/quotes");
                    const quotes = await res.json();
                    const random = quotes[Math.floor(Math.random() * quotes.length)];
                    document.getElementById("daily-quote").textContent = random.text;
                } catch {
                    document.getElementById("daily-quote").textContent = "Stay positive, drink coffee ‚òï";
                }
            }
            loadQuote();
        </script>

        <!-- Animated Neon Border for Header -->
        <style>
            header {
                border: 2px solid transparent;
                border-radius: 16px;
                background-clip: padding-box;
                position: relative;
            }
            header::after {
                content: '';
                position: absolute;
                top: -2px; left: -2px; right: -2px; bottom: -2px;
                background: linear-gradient(90deg, var(--neon-blue), var(--neon-pink), var(--cyber-yellow));
                border-radius: 18px;
                z-index: -1;
                animation: neonBorder 5s linear infinite;
                background-size: 300% 300%;
            }
            @keyframes neonBorder {
                0% { background-position: 0% 50%; }
                50% { background-position: 100% 50%; }
                100% { background-position: 0% 50%; }
            }
        </style>

        <!-- Keyboard Shortcuts -->
        <script>
            document.addEventListener("keydown", function(e) {
                if (e.key === "t") {
                    window.scrollTo({ top: 0, behavior: "smooth" });
                    showNotification("Shortcut: Back to Top", "info");
                }
                if (e.key === "m") {
                    document.getElementById("chatbotToggle").click();
                    showNotification("Shortcut: Chatbot toggled", "info");
                }
                if (e.key === "d") {
                    document.body.setAttribute("data-theme", "dark");
                    showNotification("Switched to Dark Mode", "success");
                }
                if (e.key === "l") {
                    document.body.setAttribute("data-theme", "light");
                    showNotification("Switched to Light Mode", "success");
                }
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 2 ================= -->
                <!-- ================= EXTRA FEATURES PART 4 ================= -->
        <!-- Reading Mode -->
        <button id="readingModeBtn" class="reading-mode-btn">
            <i class="fas fa-book-reader"></i>
        </button>

        <style>
            .reading-mode-btn {
                position: fixed;
                bottom: 160px;
                right: 30px;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                background: linear-gradient(135deg, #00ff8c, #00b36b);
                color: white;
                border: none;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 20px;
                z-index: 1400;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            }
            body.reading-mode {
                background: #fefae0 !important;
                color: #222 !important;
                line-height: 1.9;
                font-size: 1.15rem;
            }
        </style>

        <script>
            document.getElementById("readingModeBtn").addEventListener("click", () => {
                document.body.classList.toggle("reading-mode");
                showNotification("Reading Mode toggled", "info");
            });
        </script>

        <!-- Wave Animation Background -->
        <canvas id="waveCanvas"></canvas>

        <style>
            #waveCanvas {
                position: fixed;
                bottom: 0;
                left: 0;
                width: 100%;
                height: 200px;
                z-index: -1;
            }
        </style>

        <script>
            const waveCanvas = document.getElementById("waveCanvas");
            const waveCtx = waveCanvas.getContext("2d");
            waveCanvas.width = window.innerWidth;
            waveCanvas.height = 200;

            function drawWaves() {
                waveCtx.clearRect(0, 0, waveCanvas.width, waveCanvas.height);
                waveCtx.fillStyle = "rgba(113,88,226,0.3)";
                waveCtx.beginPath();
                for (let x = 0; x < waveCanvas.width; x++) {
                    const y = 100 + Math.sin(x * 0.02 + Date.now() * 0.002) * 20;
                    waveCtx.lineTo(x, y);
                }
                waveCtx.lineTo(waveCanvas.width, waveCanvas.height);
                waveCtx.lineTo(0, waveCanvas.height);
                waveCtx.closePath();
                waveCtx.fill();
            }
            setInterval(drawWaves, 30);
        </script>

        <!-- Control Panel -->
        <div id="control-panel" class="control-panel">
            <h4><i class="fas fa-cogs"></i> Control Panel</h4>
            <button onclick="document.body.setAttribute('data-theme','light')">Light</button>
            <button onclick="document.body.setAttribute('data-theme','dark')">Dark</button>
            <button onclick="document.body.setAttribute('data-theme','space')">Space</button>
            <button onclick="toggleSteam()">‚òï Toggle Steam</button>
        </div>

        <style>
            .control-panel {
                position: fixed;
                top: 200px;
                left: -220px;
                width: 200px;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                padding: 15px;
                border-radius: 12px;
                box-shadow: var(--shadow);
                transition: left 0.4s;
                z-index: 1600;
            }
            .control-panel:hover {
                left: 20px;
            }
            .control-panel h4 {
                font-size: 1rem;
                margin-bottom: 10px;
            }
            .control-panel button {
                display: block;
                margin: 8px 0;
                padding: 6px 12px;
                border: none;
                border-radius: 6px;
                cursor: pointer;
                width: 100%;
                font-size: 0.9rem;
                background: linear-gradient(135deg, var(--neon-blue), var(--space-purple));
                color: white;
            }
        </style>

        <script>
            function toggleSteam() {
                const steam = document.querySelectorAll(".steam");
                steam.forEach(s => {
                    if (s.style.display === "none") {
                        s.style.display = "block";
                    } else {
                        s.style.display = "none";
                    }
                });
                showNotification("Steam toggled", "info");
            }
        </script>

        <!-- Keyboard Sound Effect -->
        <audio id="key-sound" src="https://freesound.org/data/previews/256/256113_3263906-lq.mp3"></audio>

        <script>
            document.addEventListener("keypress", () => {
                const sound = document.getElementById("key-sound");
                sound.currentTime = 0;
                sound.play();
            });
        </script>

        <!-- Glow Cursor -->
        <div id="cursor-glow"></div>

        <style>
            #cursor-glow {
                position: fixed;
                width: 40px;
                height: 40px;
                border-radius: 50%;
                background: radial-gradient(circle, rgba(24,220,255,0.6), transparent 70%);
                pointer-events: none;
                mix-blend-mode: screen;
                z-index: 2000;
                transform: translate(-50%, -50%);
            }
        </style>

        <script>
            const glow = document.getElementById("cursor-glow");
            document.addEventListener("mousemove", (e) => {
                glow.style.top = e.clientY + "px";
                glow.style.left = e.clientX + "px";
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 4 ================= -->
        <!-- ================= EXTRA FEATURES PART 5 ================= -->
        <!-- Rain Effect -->
        <canvas id="rainCanvas"></canvas>

        <style>
            #rainCanvas {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -3;
                pointer-events: none;
            }
        </style>

        <script>
            const rainCanvas = document.getElementById("rainCanvas");
            const rainCtx = rainCanvas.getContext("2d");
            rainCanvas.width = window.innerWidth;
            rainCanvas.height = window.innerHeight;

            const drops = [];
            for (let i = 0; i < 150; i++) {
                drops.push({
                    x: Math.random() * rainCanvas.width,
                    y: Math.random() * rainCanvas.height,
                    length: Math.random() * 20 + 10,
                    speed: Math.random() * 4 + 2
                });
            }

            function drawRain() {
                rainCtx.clearRect(0, 0, rainCanvas.width, rainCanvas.height);
                rainCtx.strokeStyle = "rgba(24,220,255,0.5)";
                rainCtx.lineWidth = 1;
                for (let d of drops) {
                    rainCtx.beginPath();
                    rainCtx.moveTo(d.x, d.y);
                    rainCtx.lineTo(d.x, d.y + d.length);
                    rainCtx.stroke();
                    d.y += d.speed;
                    if (d.y > rainCanvas.height) d.y = -20;
                }
            }
            setInterval(drawRain, 30);
        </script>

        <!-- Matrix Effect -->
        <canvas id="matrixCanvas"></canvas>

        <style>
            #matrixCanvas {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                z-index: -4;
                pointer-events: none;
                opacity: 0.3;
            }
        </style>

        <script>
            const matrixCanvas = document.getElementById("matrixCanvas");
            const matrixCtx = matrixCanvas.getContext("2d");
            matrixCanvas.width = window.innerWidth;
            matrixCanvas.height = window.innerHeight;

            const letters = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            const fontSize = 14;
            const columns = matrixCanvas.width / fontSize;
            const dropsM = [];
            for (let i = 0; i < columns; i++) dropsM[i] = 1;

            function drawMatrix() {
                matrixCtx.fillStyle = "rgba(0, 0, 0, 0.05)";
                matrixCtx.fillRect(0, 0, matrixCanvas.width, matrixCanvas.height);
                matrixCtx.fillStyle = "#0f0";
                matrixCtx.font = fontSize + "px monospace";
                for (let i = 0; i < dropsM.length; i++) {
                    const text = letters[Math.floor(Math.random() * letters.length)];
                    matrixCtx.fillText(text, i * fontSize, dropsM[i] * fontSize);
                    if (dropsM[i] * fontSize > matrixCanvas.height && Math.random() > 0.975) {
                        dropsM[i] = 0;
                    }
                    dropsM[i]++;
                }
            }
            setInterval(drawMatrix, 50);
        </script>

        <!-- Typing Counter -->
        <div id="typing-counter" class="typing-counter">
            Keys typed: <span id="keys-count">0</span>
        </div>

        <style>
            .typing-counter {
                position: fixed;
                bottom: 20px;
                right: 300px;
                background: var(--card-bg);
                border: 1px solid var(--border-color);
                border-radius: 12px;
                padding: 8px 15px;
                box-shadow: var(--shadow);
                font-size: 0.9rem;
                color: var(--text-primary);
                z-index: 1100;
            }
        </style>

        <script>
            let keyCount = 0;
            document.addEventListener("keydown", () => {
                keyCount++;
                document.getElementById("keys-count").textContent = keyCount;
            });
        </script>

        <!-- Zen Mode -->
        <button id="zenBtn" class="zen-btn"><i class="fas fa-yin-yang"></i></button>

        <style>
            .zen-btn {
                position: fixed;
                bottom: 230px;
                right: 30px;
                width: 55px;
                height: 55px;
                border-radius: 50%;
                background: linear-gradient(135deg, #18dcff, #7158e2);
                color: white;
                border: none;
                font-size: 20px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                z-index: 1300;
                box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            }
            body.zen-mode {
                background: radial-gradient(circle, #222 0%, #000 100%) !important;
                color: #eee !important;
                font-size: 1.2rem;
                line-height: 2;
            }
        </style>

        <script>
            document.getElementById("zenBtn").addEventListener("click", () => {
                document.body.classList.toggle("zen-mode");
                showNotification("Zen Mode toggled üßò", "info");
            });
        </script>

        <!-- ================= END EXTRA FEATURES PART 5 ================= -->
            <!-- ================= NEW FEATURE: 3D COFFEE CUP ================= -->
        <section id="coffee-3d" style="margin:60px 0; text-align:center;">
            <h2 style="color:var(--text-primary); margin-bottom:20px;">‚òï 3D Coffee Cup</h2>
            <div id="three-container" style="width:100%; height:500px;"></div>
        </section>

        <!-- Three.js Library -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>

        <script>
            const container = document.getElementById("three-container");
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, container.clientWidth/container.clientHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
            renderer.setSize(container.clientWidth, container.clientHeight);
            container.appendChild(renderer.domElement);

            // Lighting
            const light = new THREE.PointLight(0xffffff, 1, 100);
            light.position.set(10, 10, 10);
            scene.add(light);

            // Cup (Cylinder + Torus as handle)
            const material = new THREE.MeshPhongMaterial({ color: 0x8B4513, shininess: 100 });
            const cup = new THREE.Mesh(new THREE.CylinderGeometry(2, 2, 4, 32, 1, false), material);
            scene.add(cup);

            // Handle
            const handle = new THREE.Mesh(new THREE.TorusGeometry(1.2, 0.3, 16, 100, Math.PI), material);
            handle.position.set(2.5, 0, 0);
            handle.rotation.z = Math.PI / 2;
            scene.add(handle);

            // Coffee surface
            const coffeeMat = new THREE.MeshPhongMaterial({ color: 0x3e2723 });
            const coffeeSurface = new THREE.Mesh(new THREE.CircleGeometry(2, 32), coffeeMat);
            coffeeSurface.rotation.x = -Math.PI / 2;
            coffeeSurface.position.y = 2;
            scene.add(coffeeSurface);

            // Floor
            const floor = new THREE.Mesh(new THREE.PlaneGeometry(20,20), new THREE.MeshPhongMaterial({color:0x444}));
            floor.rotation.x = -Math.PI/2;
            floor.position.y = -2;
            scene.add(floor);

            camera.position.z = 8;
            camera.position.y = 3;

            // Controls
            const controls = new THREE.OrbitControls(camera, renderer.domElement);

            // Animate
            function animate() {
                requestAnimationFrame(animate);
                cup.rotation.y += 0.003;
                handle.rotation.y += 0.003;
                coffeeSurface.rotation.z += 0.001;
                renderer.render(scene, camera);
            }
            animate();

            window.addEventListener("resize", () => {
                camera.aspect = container.clientWidth / container.clientHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(container.clientWidth, container.clientHeight);
            });
        </script>
        <!-- ================= END 3D COFFEE CUP ================= -->
        <!-- ================= NEW FEATURE: VISITOR CHAT ROOM ================= -->
        <section id="visitor-chat" style="margin:60px 0; text-align:center;">
            <h2 style="color:var(--text-primary); margin-bottom:15px;">üí¨ Visitor Chat Room</h2>
            <div id="chat-room" style="width:90%;max-width:500px;height:350px;border:2px solid var(--border-color);border-radius:12px;overflow-y:auto;margin:auto;background:var(--card-bg);padding:10px;text-align:left;"></div>
            <input id="chat-nick" type="text" placeholder="Enter nickname..." style="margin-top:10px;width:45%;padding:8px;border-radius:8px;border:1px solid var(--border-color);">
            <input id="chat-msg" type="text" placeholder="Type message..." style="margin-top:10px;width:45%;padding:8px;border-radius:8px;border:1px solid var(--border-color);">
            <button id="chat-send" style="padding:8px 15px;margin-top:10px;border:none;border-radius:8px;background:linear-gradient(135deg,var(--neon-blue),var(--space-purple));color:white;cursor:pointer;">Send</button>
        </section>

        <script>
            const chatRoom = document.getElementById("chat-room");
            const chatNick = document.getElementById("chat-nick");
            const chatMsg = document.getElementById("chat-msg");
            const chatSend = document.getElementById("chat-send");

            let chatHistory = JSON.parse(localStorage.getItem("visitorChat")) || [];

            function renderChat() {
                chatRoom.innerHTML = "";
                chatHistory.forEach(c => {
                    const div = document.createElement("div");
                    div.style.margin = "5px 0";
                    div.innerHTML = `<b style="color:var(--neon-blue)">${c.nick}</b>: ${c.msg}`;
                    chatRoom.appendChild(div);
                });
                chatRoom.scrollTop = chatRoom.scrollHeight;
            }
            renderChat();

            chatSend.addEventListener("click", () => {
                if (!chatNick.value || !chatMsg.value) return;
                chatHistory.push({ nick: chatNick.value, msg: chatMsg.value });
                localStorage.setItem("visitorChat", JSON.stringify(chatHistory));
                chatMsg.value = "";
                renderChat();
            });

            chatMsg.addEventListener("keypress", e => {
                if (e.key === "Enter") chatSend.click();
            });
        </script>
        <!-- ================= END VISITOR CHAT ROOM ================= -->
                  <!-- Contact Page Modal -->
        <div id="contact-modal" style="display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);z-index:2000;justify-content:center;align-items:center;">
            <div style="background:var(--card-bg);border-radius:16px;padding:30px;width:90%;max-width:500px;box-shadow:var(--shadow);position:relative;">
                <h3 style="color:var(--text-primary);margin-bottom:20px;">üì© Contact for Advertisement</h3>
                <p style="margin-bottom:10px;"><b>WhatsApp:</b> <a href="https://wa.me/966500000000" target="_blank" style="color:var(--neon-green)">+966 50 000 0000</a></p>
                <p style="margin-bottom:20px;"><b>Email:</b> <a href="mailto:ads@coffeefinder.sa" style="color:var(--neon-blue)">ads@coffeefinder.sa</a></p>
                
                <form onsubmit="sendAdRequest(event)">
                    <input type="text" id="ad-name" placeholder="Your Name" required style="width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid var(--border-color);">
                    <textarea id="ad-message" placeholder="Your Message..." required style="width:100%;padding:10px;margin-bottom:10px;border-radius:8px;border:1px solid var(--border-color);height:100px;"></textarea>
                    <button type="submit" style="padding:10px 20px;border:none;border-radius:10px;background:linear-gradient(135deg,var(--neon-blue),var(--space-purple));color:white;cursor:pointer;">Send</button>
                </form>

                <button onclick="closeContact()" style="position:absolute;top:15px;right:15px;border:none;background:none;color:var(--text-secondary);font-size:20px;cursor:pointer;">‚úñ</button>
            </div>
        </div>

        <script>
            function openContact(){
                document.getElementById("contact-modal").style.display="flex";
            }
            function closeContact(){
                document.getElementById("contact-modal").style.display="none";
            }
            function sendAdRequest(e){
                e.preventDefault();
                const name=document.getElementById("ad-name").value;
                const msg=document.getElementById("ad-message").value;
                alert(`Thanks ${name}, your request has been sent!\nMessage: ${msg}`);
                closeContact();
            }
        </script>
        <!-- =============== END ADVERTISEMENT SYSTEM =============== -->
        <!-- =============== NEW FEATURE: APP DOWNLOAD + FOOTER =============== -->
        <footer style="margin-top:80px;background:var(--header-bg);padding:40px 20px;text-align:center;border-radius:16px;box-shadow:var(--shadow);">
            <h3 style="color:white;margin-bottom:20px;">üì≤ Get the Coffee Finder Pro App</h3>
            <div style="display:flex;gap:20px;justify-content:center;flex-wrap:wrap;margin-bottom:30px;">
                <a href="#" style="display:flex;align-items:center;gap:10px;padding:12px 20px;background:black;color:white;border-radius:10px;text-decoration:none;box-shadow:0 4px 15px rgba(0,0,0,0.3);">
                    <i class="fab fa-apple fa-2x"></i>
                    <div style="text-align:left;">
                        <small>Download on the</small><br>
                        <strong>App Store</strong>
                    </div>
                </a>
                <a href="#" style="display:flex;align-items:center;gap:10px;padding:12px 20px;background:#2ecc71;color:white;border-radius:10px;text-decoration:none;box-shadow:0 4px 15px rgba(0,0,0,0.3);">
                    <i class="fab fa-google-play fa-2x"></i>
                    <div style="text-align:left;">
                        <small>Get it on</small><br>
                        <strong>Google Play</strong>
                    </div>
                </a>
            </div>

            <p style="color:white;margin-bottom:10px;">¬© 2025 Coffee Finder Pro ‚Äî All Rights Reserved</p>
            <p style="color:white;margin-bottom:20px;">‚òï Made with ‚ù§Ô∏è in Saudi Arabia</p>
            
            <div style="display:flex;gap:15px;justify-content:center;flex-wrap:wrap;">
                <a href="#privacy" style="color:var(--neon-blue);text-decoration:none;">Privacy Policy</a>
                <a href="#terms" style="color:var(--neon-green);text-decoration:none;">Terms of Service</a>
                <a href="#contact" style="color:var(--neon-pink);text-decoration:none;">Contact Us</a>
            </div>
        </footer>
        <!-- =============== END FOOTER =============== -->
                       <!-- Ads Chart -->
                <div style="background:var(--card-bg);padding:20px;border-radius:16px;box-shadow:var(--shadow);width:100%;max-width:500px;">
                    <h4 style="color:var(--neon-green);margin-bottom:10px;">Ads Requests</h4>
                    <canvas id="adsChart" height="200"></canvas>
                </div>
            </div>
        </section>

        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script>
            // Visitors Chart
            const ctx1 = document.getElementById('visitorsChart').getContext('2d');
            new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: ['Jan','Feb','Mar','Apr','May','Jun','Jul'],
                    datasets: [{
                        label: 'Visitors',
                        data: [500,800,1200,900,1500,2000,2500],
                        borderColor: '#18dcff',
                        backgroundColor: 'rgba(24,220,255,0.2)',
                        fill: true,
                        tension: 0.3
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}, scales:{x:{ticks:{color:'white'}},y:{ticks:{color:'white'}}}}
            });

            // Ratings Chart
            const ctx2 = document.getElementById('ratingsChart').getContext('2d');
            new Chart(ctx2, {
                type: 'bar',
                data: {
                    labels: ['Arabica','Starbucks','Deem','Kai','Riche'],
                    datasets: [{
                        label: 'Avg Rating',
                        data: [4.5,4.7,4.3,4.6,4.8],
                        backgroundColor: ['#ff4d8d','#18dcff','#ffd166','#00ff8c','#7158e2']
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}, scales:{x:{ticks:{color:'white'}},y:{ticks:{color:'white'}}}}
            });

            // Ads Chart
            const ctx3 = document.getElementById('adsChart').getContext('2d');
            new Chart(ctx3, {
                type: 'doughnut',
                data: {
                    labels: ['Pending','Approved','Rejected'],
                    datasets: [{
                        label: 'Ads Requests',
                        data: [5,12,3],
                        backgroundColor: ['#ffd166','#00ff8c','#ff6b6b']
                    }]
                },
                options: { responsive:true, plugins:{legend:{labels:{color:'white'}}}}
            });
        </script>
        <!-- =============== END DASHBOARD =============== -->
